(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26cac7dd"],{1646:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"el-dark-dialog",attrs:{"close-on-click-modal":!1,"before-close":t.handleClose,visible:t.apiDialogVisible,width:"40%",height:"60%",top:"10vh"},on:{"update:visible":function(e){t.apiDialogVisible=e}}},[a("div",{staticClass:"rounded p-4 card"},[a("el-row",{staticClass:"pt-3 pb-4 px-3",attrs:{type:"flex",gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-select",{staticClass:"el-dark-input",staticStyle:{width:"20%","margin-right":"10px"},attrs:{"no-data-text":t.$t("COMMON.SELECT_NO_DATA"),"value-key":"value",placeholder:"未添加"},on:{change:t.handleIsAddChange},model:{value:t.formData.isAdd,callback:function(e){t.$set(t.formData,"isAdd",e)},expression:"formData.isAdd"}},t._l(t.isAddOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t}})})),1),a("el-select",{ref:"projectRef",staticStyle:{width:"20%","margin-right":"10px"},attrs:{"no-data-text":t.$t("COMMON.SELECT_NO_DATA"),placeholder:t.$t("AUTOMATION.PLACEHOLDER.SELECT_PROJECT"),clearable:"","value-key":"id"},on:{change:t.handleProjectChange},model:{value:t.formData.projectId,callback:function(e){t.$set(t.formData,"projectId",e)},expression:"formData.projectId"}},t._l(t.projectOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),a("el-select",{ref:"groupRef",staticStyle:{width:"20%","margin-right":"10px"},attrs:{"no-data-text":t.$t("COMMON.SELECT_NO_DATA"),clearable:"",placeholder:t.$t("AUTOMATION.PLACEHOLDER.SELECT_GROUP")},on:{change:t.handleGroupChange},model:{value:t.formData.groupId,callback:function(e){t.$set(t.formData,"groupId",e)},expression:"formData.groupId"}},t._l(t.groupOptions,(function(t,e){return a("el-option",{key:e,attrs:{label:t.device_group,value:t.id}})})),1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.listData}},[a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.DEVICE_NAME"),prop:"device_name",width:"160px"}}),a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.PROJECT_NAME"),prop:"business_name",width:"160px"}}),a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.GROUP_NAME"),prop:"asset_name",width:"160px"}}),a("el-table-column",{attrs:{prop:"actions",label:t.$t("RULE_ENGINE.DATA_GATEWAY.OPERATION"),align:"left",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==t.formData.isAdd.value?a("el-button",{attrs:{size:"mini",type:"indigo"},on:{click:function(a){return t.handleAddRelationship(e.row)}}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.ADD")))]):t._e(),1==t.formData.isAdd.value?a("el-button",{attrs:{size:"mini",type:"indigo"},on:{click:function(a){return t.handleDeleteRelationship(e.row)}}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.DELETE")))]):t._e()]}}])})],1),a("div",{staticClass:"text-right py-3"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:t.data_count,"current-page":t.page,"page-size":t.page_size},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.page_change}})],1),a("div",[a("el-button",{attrs:{size:"mini",type:"indigo"},on:{click:t.handleClose}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.CLOSE")))])],1)],1)])},i=[],o=a("d956"),d=a("2b6d"),r=a("308f"),s=a("f570"),u={name:"DeviceAccessScopeForm",props:{id:{default:null},data:{default:null},visible:{type:[Boolean],default:!1},initForm:{isAdd:{name:s["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_NOT_ADDED"),value:0},projectId:"",groupId:"",deviceId:"",device:{},state:{duration:{},operator:{symbol:"",value:""}}}},computed:{apiDialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},watch:{visible:{handler:function(t){t&&this.id&&(this.loading=!0,this.page=1,this.get_device_data(),this.data_count=this.listData.length,this.getProjectChoice())}}},data:function(){return{signMethodChoice:["MD5","HAS256"],apiAccessScopeChoice:[{name:s["a"].t("RULE_ENGINE.DATA_GATEWAY.ALL"),value:1},{name:s["a"].t("RULE_ENGINE.DATA_GATEWAY.PART"),value:2}],deviceAccessScopeChoice:[{name:s["a"].t("RULE_ENGINE.DATA_GATEWAY.ALL"),value:1},{name:s["a"].t("RULE_ENGINE.DATA_GATEWAY.PART"),value:2}],isAddOptions:[{name:s["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_NOT_ADDED"),value:0},{name:s["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_ADDED"),value:1}],projectOptions:[],groupOptions:[],listData:[],addedDeviceIdList:[],loading:!1,page:0,page_size:5,data_count:0,formData:{isAdd:{name:s["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_NOT_ADDED"),value:0},projectId:"",groupId:"",deviceId:"",device:{},state:{duration:{},operator:{symbol:"",value:""}}}}},methods:{get_device_data:function(){var t=this,e={current_page:this.page,per_page:this.page_size,tp_openapi_auth_id:this.id,is_add:this.formData.isAdd.value,business_id:this.formData.projectId,asset_id:this.formData.groupId};Object(o["f"])(e).then((function(e){200==e.data.code&&(t.listData=e.data.data.data,t.data_count=e.data.data.total,t.loading=!1)}))},page_change:function(t){this.loading=!0,this.page=t,this.get_device_data()},handleClose:function(){this.page=1,this.formData={isAdd:{name:s["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_NOT_ADDED"),value:0},projectId:"",groupId:"",deviceId:"",device:{},state:{duration:{},operator:{symbol:"",value:""}}},this.listData=[],this.apiDialogVisible=!1},cancelDialog:function(){this.page=1,this.formData={isAdd:{name:s["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_NOT_ADDED"),value:0},projectId:"",groupId:"",deviceId:"",device:{},state:{duration:{},operator:{symbol:"",value:""}}},this.listData=[],this.apiDialogVisible=!1},handleDeleteRelationship:function(t){var e=this;this.loading=!0;var a={tp_openapi_auth_id:this.id,device_id:t.device_id};Object(o["c"])(a).then((function(t){var a=t.data;200==a.code&&e.$message({message:s["a"].t("COMMON.DELETE_SUCCESS"),center:!0,type:"success"}),e.loading=!1})),this.get_device_data()},handleAddRelationship:function(t){var e=this;this.loading=!0;var a={tp_openapi_auth_id:this.id,device_id:t.device_id};Object(o["a"])(a).then((function(t){var a=t.data;200==a.code&&e.$message({message:s["a"].t("COMMON.ADD_SUCCESS"),center:!0,type:"success"}),e.loading=!1,e.get_device_data()}))},getProjectChoice:function(){var t=this;Object(d["d"])({limit:100,page:1}).then((function(e){var a=e.data;200==a.code&&(t.projectOptions=a.data?a.data.data:[])}))},getGroupList:function(t){var e=this;Object(r["i"])({business_id:t}).then((function(t){var a=t.data;200==a.code&&(e.groupOptions=(null===a||void 0===a?void 0:a.data)||[])}))},handleProjectChange:function(t){this.loading=!0,this.page=1,this.formData.projectId=t,this.formData.groupId="",this.get_device_data(),t&&this.getGroupList(t)},handleGroupChange:function(t){this.page=1,this.loading=!0,this.formData.groupId=t,this.get_device_data()},handleIsAddChange:function(t){this.loading=!0,this.page=1,this.formData.isAdd=t,this.get_device_data()},validate:function(){return!0}}},c=u,l=(a("72ff"),a("2877")),p=Object(l["a"])(c,n,i,!1,null,"4e0d005b",null);e["default"]=p.exports},"2b6d":function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return d})),a.d(e,"b",(function(){return r}));var n=a("18a6");function i(t){return Object(n["a"])({url:"/business/index",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/business/add",method:"post",data:t})}function d(t){return Object(n["a"])({url:"/business/edit",method:"post",data:t})}function r(t){return Object(n["a"])({url:"/business/delete",method:"post",data:t})}},"308f":function(t,e,a){"use strict";a.d(e,"c",(function(){return o})),a.d(e,"j",(function(){return d})),a.d(e,"d",(function(){return r})),a.d(e,"e",(function(){return s})),a.d(e,"f",(function(){return u})),a.d(e,"i",(function(){return c})),a.d(e,"g",(function(){return l})),a.d(e,"h",(function(){return p})),a.d(e,"a",(function(){return h})),a.d(e,"b",(function(){return f}));var n=a("5530"),i=(a("2ca0"),a("d3b7"),a("d81d"),a("18a6"));function o(){return Object(i["a"])({url:"/asset/index",method:"post"})}function d(t){return Object(i["a"])({url:"/structure/field",method:"post",data:t})}function r(t){return Object(i["a"])({url:"/asset/list",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/asset/list/a",method:"post",data:t})}function u(t){return Object(i["a"])({url:"/asset/list/b",method:"post",data:t})}function c(t){var e=function(t){return t&&t.startsWith("/")?t.substring(1):t};return new Promise((function(a,n){Object(i["a"])({url:"/asset/list/d",method:"post",data:t}).then((function(t){var n=t.data.data.map((function(t){return t.device_group=e(t.device_group),t}));t.data.data=n,a(t)})).catch((function(t){n(t)}))}))}function l(t){return Object(i["a"])({url:"/asset/list/c",method:"post",data:t})}function p(t){return Object(i["a"])({url:"/asset/update_only",method:"post",data:t})}function h(t){return Object(i["a"])({url:"/asset/add_only",method:"post",data:t})}function f(t){return Object(i["a"])({url:"/asset/delete",method:"post",data:Object(n["a"])({type:1},t)})}},"72ff":function(t,e,a){"use strict";a("ecd6")},d956:function(t,e,a){"use strict";a.d(e,"g",(function(){return i})),a.d(e,"b",(function(){return o})),a.d(e,"i",(function(){return d})),a.d(e,"d",(function(){return r})),a.d(e,"e",(function(){return s})),a.d(e,"h",(function(){return u})),a.d(e,"f",(function(){return c})),a.d(e,"a",(function(){return l})),a.d(e,"c",(function(){return p}));var n=a("18a6");function i(t){return Object(n["a"])({url:"/openapi/auth/list",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/openapi/auth/add",method:"post",data:t})}function d(t){return Object(n["a"])({url:"/openapi/auth/edit",method:"post",data:t})}function r(t){return Object(n["a"])({url:"/openapi/auth/del",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/openapi/api/list",method:"post",data:{tp_openapi_auth_id:t,current_page:1,per_page:1e4,name:"",api_type:"",service_type:""}})}function u(t){return Object(n["a"])({url:"/openapi/rapi/edit",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/device/business/asset/permissions",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/openapi/rdevice/add",method:"post",data:t})}function p(t){return Object(n["a"])({url:"/openapi/rdevice/del",method:"post",data:t})}},ecd6:function(t,e,a){}}]);