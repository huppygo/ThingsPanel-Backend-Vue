(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dd4c3bfc"],{"045f":function(t,e,i){"use strict";i("455b")},"0474":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-row",{staticStyle:{"margin-bottom":"10px"}},[i("el-col",[i("el-button",{attrs:{type:"border",size:"medium"},on:{click:t.showDialog}},[t._v(t._s(t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.DELIVERY_ATTRIBUTE")))])],1)],1),i("el-row",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.attributeLoading,expression:"attributeLoading"}],staticStyle:{width:"100%"},attrs:{data:t.attributeList},scopedSlots:t._u([{key:"empty",fn:function(){return[i("div",[t._v(t._s(t.$t("COMMON.TABLE_NO_DATA")))])]},proxy:!0}])},[i("el-table-column",{attrs:{prop:"key",label:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.ATTRIBUTE_IDENTIFIER"),"min-width":"90",align:"center"}}),i("el-table-column",{attrs:{prop:"name",label:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.ATTRIBUTE_NAME"),"min-width":"80",align:"center"}}),i("el-table-column",{attrs:{prop:"str_v",label:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.ATTRIBUTE_VALUE"),"min-width":"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.str_v?e.row.str_v:e.row.dbl_v)+" ")]}}])}),i("el-table-column",{attrs:{prop:"ts",label:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.UPDATE_TIME"),"min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.transformTimestamp(e.row.ts))+" ")]}}])}),i("el-table-column",{attrs:{prop:"value",label:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.HISTORY_DATA"),"min-width":"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("i",{staticClass:"el-icon-notebook-2",staticStyle:{padding:"3px 5px",cursor:"pointer"},on:{click:function(i){return t.showDeviceHistory(e.row.key)}}})]}}])}),i("el-table-column",{attrs:{prop:"value",label:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.CHART_ANALYSIS"),"min-width":"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isShowDataChart(e.row)?i("i",{staticClass:"el-icon-pie-chart",staticStyle:{padding:"3px 5px",cursor:"pointer"},on:{click:function(i){return t.showDeviceDataChart(e.row.key)}}}):i("i",{staticClass:"el-icon-pie-chart",staticStyle:{padding:"3px 5px",cursor:"not-allowed"}})]}}])}),i("el-table-column",{attrs:{prop:"value",label:t.$t("COMMON.OPERATION"),"min-width":"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-popconfirm",{attrs:{"confirm-button-text":t.$t("COMMON.CONFIRM"),"cancel-button-text":t.$t("COMMON.CANCEL"),title:t.$t("COMMON.DELETE_CONFIRM")},on:{confirm:function(i){return t.deleteHistoryData(e.row.key)}}},[i("el-button",{attrs:{slot:"reference",size:"mini",type:"border"},slot:"reference"},[t._v(" "+t._s(t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.DELETE_HISTORY_DATA"))+" ")])],1)]}}])})],1)],1),i("el-dialog",{staticClass:"el-dark-dialog el-dark-input dialog-css",attrs:{title:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.DELIVERY_ATTRIBUTE"),width:"30%","close-on-press-escape":!1,"show-close":"","append-to-body":"",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleClose}},[i("div",[i("h3",[t._v(t._s(t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.ATTRIBUTE_JSON_OBJECT")))])]),i("CodeEditor",{key:"upside",staticClass:"dark-code-editor",staticStyle:{width:"100%",height:"260px","overflow-y":"auto"},attrs:{min_height:"260px",copy_code:!0,hide_header:!1,theme:"dark",wrap_code:!0},model:{value:t.deliveryAttribute,callback:function(e){t.deliveryAttribute=e},expression:"deliveryAttribute"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"cancel"},on:{click:t.handleClose}},[t._v(t._s(t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.CANCEL")))]),i("el-button",{attrs:{type:"save"},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.CONFIRM")))])],1)],1),i("DeviceHistory",{attrs:{visible:t.deviceHistoryVisible,device:t.device,attributeName:t.attributeName},on:{"update:visible":function(e){t.deviceHistoryVisible=e}}}),i("DeviceDataChart",{attrs:{visible:t.deviceDataChartVisible,device:t.device,attributeName:t.attributeName},on:{"update:visible":function(e){t.deviceDataChartVisible=e}}})],1)},o=[],n=(i("d3b7"),i("4de4"),i("f314")),r=i("aa98"),s=i("3de1"),l=i("31e1"),c=i("6d09"),d=i("2fa3"),u=i("f570"),E={name:"Attribute",components:{CodeEditor:n["a"],DeviceHistory:l["default"],DeviceDataChart:c["default"]},props:{device:{type:[Object],default:function(){return{}}}},data:function(){return{dialogVisible:!1,deviceHistoryVisible:!1,deviceDataChartVisible:!1,attributeName:"",deliveryAttribute:"",attributeList:[],tableData:[],attributeLoading:!1}},computed:{},watch:{},mounted:function(){console.log("DeviceAttribute",this.device),this.getAttributeList()},methods:{getAttributeList:function(){var t=this;this.attributeLoading=!0,Object(r["c"])({device_id:this.device.id}).then((function(e){var i=e.data;if(console.debug("====getAttributeList",i),200==i.code){var a=i.data?i.data:[];t.attributeList=a.filter((function(t){return"systime"!==t.key&&"SYS_ONLINE"!==t.key}))}})).finally((function(){t.attributeLoading=!1}))},handleClose:function(){this.dialogVisible=!1,this.deliveryAttribute=""},showDialog:function(){this.dialogVisible=!0},transformTimestamp:function(t){return Object(s["a"])(t)},showDeviceHistory:function(t){this.deviceHistoryVisible=!0,this.attributeName=t},showDeviceDataChart:function(t){this.deviceDataChartVisible=!0,this.attributeName=t},deleteHistoryData:function(t){var e=this;this.attributeLoading=!0,Object(r["d"])({device_id:this.device.id,attribute:t}).then((function(t){var i=t.data;200===i.code?Object(d["i"])(u["a"].t("COMMON.DELETE_SUCCESS")):Object(d["h"])(u["a"].t("COMMON.DELETE_FAILED")),e.getAttributeList()}))},handleSubmit:function(){var t;try{t=JSON.parse(this.deliveryAttribute)}catch(e){t={}}console.debug("handleSubmit",t),Object(r["z"])({device_id:this.device.id,values:t}).then((function(t){var e=t.data;200===e.code?Object(d["i"])(u["a"].t("COMMON.EDIT_SUCCESS")):Object(d["h"])(u["a"].t("COMMON.EDIT_FAILED"))}))},isShowDataChart:function(t){if(!t)return!1;var e=t.str_v?t.str_v:t.dbl_v;return!e||"number"===typeof e}}},p=E,b=(i("2449"),i("2877")),h=Object(b["a"])(p,a,o,!1,null,"8adb6202",null);e["default"]=h.exports},2449:function(t,e,i){"use strict";i("6fc1")},"31e1":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"el-dark-dialog el-dark-input",attrs:{title:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE_HISTORY_DATA"),width:"50%","close-on-press-escape":!1,"show-close":"","append-to-body":"",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleClose}},[i("div",[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:11}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","start-placeholder":t.$t("DATA_MANAGEMENT.PLACEHOLDER5"),"range-separator":t.$t("DATA_MANAGEMENT.PLACEHOLDER6"),"end-placeholder":t.$t("DATA_MANAGEMENT.PLACEHOLDER7")},on:{change:function(e){return t.getHistoryData()}},model:{value:t.choosedTimeRange,callback:function(e){t.choosedTimeRange=e},expression:"choosedTimeRange"}})],1),i("el-col",{attrs:{span:3}},[i("el-button",{attrs:{type:"border",size:"medium"},on:{click:function(e){return t.handleRefresh()}}},[t._v(t._s(t.$t("COMMON.REFRESH")))])],1),i("el-col",{staticStyle:{float:"right"},attrs:{span:3}},[i("el-popconfirm",{attrs:{"confirm-button-text":t.$t("COMMON.CONFIRM"),"cancel-button-text":t.$t("COMMON.CANCEL"),title:t.$t("COMMON.EXPORT_CONFIRM")},on:{confirm:function(e){return t.handleExport()}}},[i("el-button",{attrs:{slot:"reference",type:"border",size:"medium"},slot:"reference"},[t._v(t._s(t.$t("COMMON.EXPORT")))])],1)],1)],1),i("el-table",{attrs:{data:t.historyData},scopedSlots:t._u([{key:"empty",fn:function(){return[i("div",[t._v(t._s(t.$t("COMMON.TABLE_NO_DATA")))])]},proxy:!0}])},[i("el-table-column",{attrs:{type:"index",width:"50",align:"center"}}),i("el-table-column",{attrs:{prop:"time",label:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.TIMESTAMP"),"min-width":"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t.transformTimestamp(e.row.ts)))])]}}])}),i("el-table-column",{attrs:{prop:"key",label:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.ATTRIBUTE.ATTRIBUTE_IDENTIFIER"),"min-width":"200",align:"center"}},[t._v(t._s(this.attributeName))]),i("el-table-column",{attrs:{prop:"value",label:t.$t("DEVICE_MANAGEMENT.DEVICE_CONFIG.VALUE"),"min-width":"200",align:"center"}})],1),i("div",{staticClass:"text-center py-3"},[i("el-row",{attrs:{type:"flex",justify:"center"}},[i("el-col",{staticStyle:{display:"inline-block"},attrs:{span:8}},[i("el-button",{staticStyle:{width:"45px","border-color":"#747474"},attrs:{icon:"el-icon-back",type:"border",disabled:1===this.page,size:"small"},on:{click:function(e){return t.pageChange(t.page-1)}}}),i("el-button",{staticStyle:{width:"45px","border-color":"#747474"},attrs:{icon:"el-icon-right",type:"border",disabled:this.dataCount!==this.pageSize,size:"small"},on:{click:function(e){return t.pageChange(t.page+1)}}})],1)],1)],1)],1),i("el-dialog",{staticClass:"el-dark-dialog el-dark-input",attrs:{width:"30%","append-to-body":"",title:t.$t("COMMON.EXPORT"),visible:t.exportVisible},on:{"update:visible":function(e){t.exportVisible=e}}},[i("div",{staticClass:"text-center"},[i("p",[t._v(t._s(t.downloadUrl?t.downloadUrl.split("/").pop().toString():t.$t("COMMON.GENERATE_WAIT")))]),t.exporting?t._e():i("p",[i("a",{attrs:{href:t.downloadUrl}},[t._v(t._s(t.$t("COMMON.DOWNLOAD")))])])])])],1)},o=[],n=(i("d3b7"),i("aa98")),r=i("3de1"),s={name:"DeviceHistory",props:{visible:{type:[Boolean],default:!1},data:{type:Object,default:function(){return{}}},device:{type:[Object],default:function(){return{}}},attributeName:{type:String,default:""}},data:function(){var t=Date.now();return{historyData:[],positionShow:!1,locationArray:[],choosedTimeRange:[new Date(t-36e5),new Date(t)],isCopy:!1,pageSize:10,page:1,dataCount:0,exporting:!1,exportVisible:!1,downloadUrl:""}},computed:{formData:{get:function(){return this.data},set:function(t){this.$emit("update:data",t)}},dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},watch:{dialogVisible:{handler:function(t){console.debug("DeviceHistory",this),t&&this.getHistoryData()}}},mounted:function(){},methods:{getHistoryData:function(t,e){var i=this,a=1e3*new Date(this.choosedTimeRange[0]).getTime(),o=1e3*new Date(this.choosedTimeRange[1]).getTime();Object(n["t"])({device_id:this.device.id,key:this.attributeName,start_time:a,end_time:o,page:t||this.page,page_records:e||this.pageSize}).then((function(t){var e=t.data;console.debug("====getHistoryData",e),200==e.code&&(i.historyData=e.data?e.data:[],i.dataCount=i.historyData.length),console.debug(i.historyData)}))},handleClose:function(){this.dialogVisible=!1,this.page=1,this.pageSize=10},transformTimestamp:function(t){return Object(r["a"])(t)},pageChange:function(t){this.page=t,this.getHistoryData()},handleExport:function(){var t=this;if(!this.exporting){this.exporting=!0,this.exportVisible=!0;var e=1e3*new Date(this.choosedTimeRange[0]).getTime(),i=1e3*new Date(this.choosedTimeRange[1]).getTime();Object(n["t"])({device_id:this.device.id,key:this.attributeName,start_time:e,end_time:i,page:this.page,page_records:this.pageSize,export_excel:!0}).then((function(e){var i=e.data;console.debug("====handleExport",i),200==i.code&&(t.downloadUrl=i.data?i.data:"")})).finally((function(){t.exporting=!1}))}},handleRefresh:function(){var t=Date.now();this.choosedTimeRange=[new Date(t-36e5),new Date(t)],this.getHistoryData()}}},l=s,c=(i("045f"),i("2877")),d=Object(c["a"])(l,a,o,!1,null,"de42b222",null);e["default"]=d.exports},"455b":function(t,e,i){},"6fc1":function(t,e,i){}}]);