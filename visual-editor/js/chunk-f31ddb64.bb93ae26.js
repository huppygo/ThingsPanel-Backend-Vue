(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f31ddb64","chunk-2e90bb58","chunk-77836d54"],{"09ed":function(t,e,a){"use strict";a("4ce4")},"239d":function(t,e,a){"use strict";var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h3",{staticClass:"table-title h3 font-weight-bolder m-0 pt-2"},[t._t("default")],2)},i=[],n={name:"TableTitle"},o=n,r=a("2877"),s=Object(r["a"])(o,l,i,!1,null,"2001a59c",null);e["a"]=s.exports},"2a82":function(t,e,a){"use strict";a("e0a0")},"427f":function(t,e,a){"use strict";a("e9b6")},"4ce4":function(t,e,a){},9448:function(t,e,a){"use strict";var l=a("18a6");e["a"]={add:function(t){return Object(l["a"])({url:"/device/model/add",method:"post",data:t})},edit:function(t){return Object(l["a"])({url:"/device/model/edit",method:"post",data:t})},del:function(t){return Object(l["a"])({url:"/device/model/delete",method:"post",data:t})},page:function(t){return Object(l["a"])({url:"/device/model/list",method:"post",data:t})},tree:function(t){return Object(l["a"])({url:"/device/model/tree",method:"post",data:t})},category:function(t){return Object(l["a"])({url:"/dict/list/",method:"post",data:t})},map:function(t){return Object(l["a"])({url:"/device/map",method:"post",data:t})},equip:function(t){return Object(l["a"])({url:"/kv/current/symbol",method:"post",data:t})},state:function(t){return Object(l["a"])({url:"/device/status",method:"post",data:t})}}},"99d2":function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{staticClass:"el-dark-dialog",attrs:{title:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.CREATEPRODUCT"),visible:t.dialogVisible,width:"30%","before-close":t.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{staticClass:"el-dark-input",attrs:{"label-position":"top",model:t.formData,rules:t.formRules}},[a("el-form-item",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.PRODUCTNAME"),prop:"name"}},[a("el-input",{model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.PRODUCTNUMBER"),prop:"serial_number"}},[a("el-input",{model:{value:t.formData.serial_number,callback:function(e){t.$set(t.formData,"serial_number",e)},expression:"formData.serial_number"}})],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.PROTOCOLTYPE1"),prop:"protocol_type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.PLACEHOLDER42")},model:{value:t.formData.protocol_type,callback:function(e){t.$set(t.formData,"protocol_type",e)},expression:"formData.protocol_type"}},t._l(t.protocolOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.PROTOCOLTYPE2"),prop:"auth_type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.PLACEHOLDER43")},model:{value:t.formData.auth_type,callback:function(e){t.$set(t.formData,"auth_type",e)},expression:"formData.auth_type"}},t._l(t.authOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1)],1),a("el-form-item",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.TITLE32")}},[a("el-input",{nativeOn:{click:function(e){return t.handleBindPlugin.apply(null,arguments)}},model:{value:t.formData.pluginName,callback:function(e){t.$set(t.formData,"pluginName",e)},expression:"formData.pluginName"}})],1),a("el-form-item",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.PRODUCTDESCRIPTION")}},[a("el-input",{model:{value:t.formData.describe,callback:function(e){t.$set(t.formData,"describe",e)},expression:"formData.describe"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"cancel"},on:{click:t.handleClose}},[t._v(t._s(t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.CANCEL")))]),a("el-button",{attrs:{type:"save"},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCT_LIST_ADD.CONFIRM")))])],1)],1),a("plugin-binding-form",{attrs:{"dialog-visible":t.pluginDialogVisible},on:{"update:dialogVisible":function(e){t.pluginDialogVisible=e},"update:dialog-visible":function(e){t.pluginDialogVisible=e},submit:t.handleBindPluginSubmit}})],1)},i=[],n=(a("e9c4"),a("c4c8")),o=a("2fa3"),r=a("fc07"),s=a("f570"),u=!0,c={name:"CreateProduct",components:{PluginBindingForm:r["default"]},props:{visible:{type:[Boolean],default:!1},data:{type:[Object],default:function(){return{}}}},data:function(){return{formData:{name:"",serial_number:"",protocol_type:"",auth_type:"",plugin:"",describe:""},formRules:{name:[{required:u,message:s["a"].t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PLACEHOLDER1")}],serial_number:[{required:u,message:s["a"].t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PLACEHOLDER2")}],protocol_type:[{required:u,message:s["a"].t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PLACEHOLDER3")}],auth_type:[{required:u,message:s["a"].t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PLACEHOLDER4")}]},dialogVisible:!1,protocolOptions:[{value:"mqtt",label:"MQTT直连"},{value:"MQTT",label:"MQTT网关"}],authOptions:[{value:"1",label:"AccessToken "},{value:"2",label:"MQTTBasic"}],pluginList:[],pluginDialogVisible:!1}},watch:{visible:{handler:function(t){t&&(this.formData=JSON.parse(JSON.stringify(this.data)),this.dialogVisible=t)}}},methods:{handleSubmit:function(){var t=this;this.formData.id?console.log("edit"):(this.formData.plugin="{}",n["a"].add(this.formData).then((function(e){var a=e.data;200==a.code&&(t.$emit("submit"),Object(o["i"])("产品添加成功！"),t.handleClose())})))},handleBindPlugin:function(t){this.pluginDialogVisible=!0},handleBindPluginSubmit:function(t,e){console.log("handleBindPluginSubmit",t),this.formData.device_model_id=t,this.formData.pluginName=e},handleClose:function(){this.dialogVisible=!1,this.$emit("update:visible",!1)}}},d=c,p=(a("2a82"),a("2877")),f=Object(p["a"])(d,l,i,!1,null,"76abcfba",null);e["default"]=f.exports},c4c8:function(t,e,a){"use strict";var l=a("18a6"),i=a("add0"),n="/tp_product",o="/tp_batch";e["a"]={add:function(t){return Object(l["a"])({url:n+"/add",method:"post",data:t})},edit:function(t){return Object(l["a"])({url:n+"/edit",method:"post",data:t})},del:function(t){return Object(l["a"])({url:n+"/delete",method:"post",data:t})},page:function(t){return Object(l["a"])({url:n+"/list",method:"post",data:t})},batchAdd:function(t){return Object(l["a"])({url:o+"/add",method:"post",data:t})},batchEdit:function(t){return Object(l["a"])({url:o+"/edit",method:"post",data:t})},batchDel:function(t){return Object(l["a"])({url:o+"/delete",method:"post",data:t})},batchPage:function(t){return Object(l["a"])({url:o+"/list",method:"post",data:t})},generateBatch:function(t){return Object(l["a"])({url:o+"/generate",method:"post",data:t})},uploadUrl:i["a"]+"api/file/up",importBatch:function(t){return Object(l["a"])({url:o+"/import",method:"post",data:t})},exportQRCodeAndData:function(t){return Object(l["a"])({url:o+"/export",method:"post",data:t})},getPreRegistration:function(t){return Object(l["a"])({url:"/tp_generate_device/list",method:"post",data:t})},generateDevice:function(t){return Object(l["a"])({url:"/tp_generate_device/activate",method:"post",data:t})},deletePreRegistration:function(t){return Object(l["a"])({url:"/tp_generate_device/delete",method:"post",data:t})},getDeviceListByProductId:function(t){return Object(l["a"])({url:"/device/listbyproduct",method:"post",data:t})},addTask:function(t){return Object(l["a"])({url:"/tp_ota_task/add",method:"post",data:t})}}},e0a0:function(t,e,a){},e5a4:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rounded card p-4"},[a("el-row",{staticClass:"pt-3 pb-4 px-3",attrs:{type:"flex",gutter:20}},[a("el-col",{attrs:{span:12}},[a("TableTitle",[t._v(t._s(t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCTLIST")))])],1),a("el-col",{staticClass:"px-2 text-right",attrs:{span:12}},[a("el-button",{attrs:{size:"medium",type:"border"},on:{click:t.handleCreate}},[t._v(t._s(t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.CREATEPRODUCT")))])],1)],1),a("el-form",{staticClass:"inline-edit"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableData},scopedSlots:t._u([{key:"empty",fn:function(){return[a("div",[t._v(t._s(t.$t("COMMON.TABLE_NO_DATA")))])]},proxy:!0}])},[a("el-table-column",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCTNUMBER"),prop:"serial_number",align:"left"}}),a("el-table-column",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCTNAME"),prop:"name",align:"left"}}),a("el-table-column",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PROTOCOLTYPE1"),prop:"protocol_type",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{effect:"plain",type:"border"}},[t._v(t._s(e.row.protocol_type))])]}}])}),a("el-table-column",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.AUTHENTICATION"),prop:"auth_type",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.auth_type?a("el-tag",{attrs:{effect:"plain",type:"border"}},[t._v("AccessToken")]):"2"==e.row.auth_type?a("el-tag",{attrs:{effect:"plain",type:"border"}},[t._v("MQTTBasic")]):t._e()]}}])}),a("el-table-column",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.PRODUCTDESCRIPTION"),prop:"describe",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.describe?e.row.describe:"--")+" ")]}}])}),a("el-table-column",{attrs:{label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.CREATEDATE"),prop:"created",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.created?e.row.created:"--")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.OPERATION"),width:"230"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{staticClass:"mr-3",attrs:{type:"indigo",size:"mini"},on:{click:function(a){return t.showBatch(e.row)}}},[t._v(t._s(t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.BATCH_OPERATION")))]),a("el-popconfirm",{attrs:{"confirm-button-text":t.$t("COMMON.CONFIRM"),"cancel-button-text":t.$t("COMMON.CANCEL"),title:t.$t("AUTOMATION.TITLE4")},on:{confirm:function(a){return t.handleDelete(e.row)}}},[a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[t._v(t._s(t.$t("PRODUCT_MANAGEMENT.PRODUCT_LIST.DELETE")))])],1)],1)]}}])})],1)],1),a("div",{staticClass:"text-right py-3"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.params.total,"current-page":t.params.current_page,"page-size":t.params.per_page},on:{"update:currentPage":function(e){return t.$set(t.params,"current_page",e)},"update:current-page":function(e){return t.$set(t.params,"current_page",e)},"current-change":t.getProductList}})],1),a("create-product",{attrs:{visible:t.createDialogVisible,data:{}},on:{"update:visible":function(e){t.createDialogVisible=e},submit:t.handleSearch}})],1)},i=[],n=(a("d3b7"),a("d81d"),a("b0c0"),a("239d")),o=a("c4c8"),r=a("99d2"),s=a("2fa3"),u=a("3de1"),c={name:"index",components:{CreateProduct:r["default"],TableTitle:n["a"]},data:function(){return{tableData:[],loading:!1,createDialogVisible:!1,params:{serialNumber:"",total:0,current_page:1,per_page:10}}},mounted:function(){this.getProductList()},methods:{getProductList:function(){var t=this;this.loading=!0,this.params.serial_number="%"+this.params.serialNumber+"%",o["a"].page(this.params).then((function(e){var a=e.data;200==a.code&&(t.tableData=a.data.data.map((function(t){return t.created=Object(u["a"])(t.created_time),t})))})).finally((function(){t.loading=!1}))},handleSearch:function(){this.getProductList()},handleCreate:function(){this.createDialogVisible=!0},showBatch:function(t){this.$router.push({name:"BatchList",query:{product_id:t.id,product_name:t.name}})},handleDelete:function(t){var e=this;o["a"].del({id:t.id}).then((function(t){var a=t.data;200==a.code&&(Object(s["i"])("产品删除成功"),e.getProductList())}))}}},d=c,p=(a("09ed"),a("2877")),f=Object(p["a"])(d,l,i,!1,null,"8fd13a68",null);e["default"]=f.exports},e9b6:function(t,e,a){},fc07:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"el-dark-dialog el-dark-input",attrs:{title:t.$t("COMMON.PLACEHOLDER44"),visible:t.showDialog,width:"1000px"},on:{"update:visible":function(e){t.showDialog=e}}},[a("div",{staticClass:"container-fluid"},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"tree-div",staticStyle:{"border-right":"4px solid #263373"}},[t.showDialog?a("el-tree",{ref:"tree",staticClass:"el-dark-tree plugin-binding-tree",attrs:{"default-expanded-keys":t.defaultExpandKeys,"node-key":"id",data:t.pluginTree,props:{children:"device_model",label:"model_name"}},on:{"node-click":t.nodeClick}}):t._e()],1)]),a("el-col",{attrs:{span:18}},[a("tsl-editor",{staticClass:"tsl-editor",attrs:{"show-view":!1,data:t.tslData}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"cancel"},on:{click:function(e){t.showDialog=!1}}},[t._v(t._s(t.$t("COMMON.CANCEL")))]),a("el-button",{attrs:{type:"save"},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("COMMON.CONFIRM")))])],1)])},i=[],n=a("ed09"),o=a("9448"),r=(a("2fa3"),Object(n["c"])({name:"PluginBinding",props:{dialogVisible:{type:[Boolean],default:!1},data:{type:[Object],default:function(){return{}}}},setup:function(t,e){var a=Object(n["i"])(null),l=Object(n["i"])([]),i=Object(n["a"])({get:function(){if(u.value={},t.dialogVisible){var e=t.data.pluginId;if(!e)return t.dialogVisible;l.value.push(e),Object(n["e"])((function(){a.value.setCurrentKey(e)})),f(e)}else l.value=[];return t.dialogVisible},set:function(t){e.emit("update:dialogVisible",t)}}),r=Object(n["i"])([]);function s(){o["a"].tree({}).then((function(t){var e=t.data;200==e.code&&(console.log("PluginAPI.tree",e.data),r.value=e.data)}))}s();var u=Object(n["i"])({}),c="",d="";function p(t){t["dict_value"]||f(t.id)}function f(t){c=t,o["a"].page({current_page:1,per_page:10,id:t}).then((function(t){var e,a=t.data;200==a.code&&(console.log("getPluginData",a.data.data[0]),d=(null===(e=a.data.data[0])||void 0===e?void 0:e.model_name)||"",u.value=JSON.parse(a.data.data[0].chart_data).tsl)}))}function T(){this.showDialog=!1,this.$emit("submit",c,d)}return{tree:a,defaultExpandKeys:l,pluginTree:r,showDialog:i,tslData:u,nodeClick:p,handleSubmit:T}}})),s=r,u=(a("427f"),a("2877")),c=Object(u["a"])(s,l,i,!1,null,"5571bdea",null);e["default"]=c.exports}}]);