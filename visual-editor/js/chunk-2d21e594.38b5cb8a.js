(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21e594"],{d4d2:function(e,t,n){"use strict";n.r(t),n.d(t,"setConditions",(function(){return y})),n.d(t,"setActions",(function(){return v})),n.d(t,"getConditions",(function(){return g})),n.d(t,"getActions",(function(){return l})),n.d(t,"ConditionType",(function(){return i})),n.d(t,"StateMode",(function(){return r})),n.d(t,"TimeType",(function(){return c})),n.d(t,"RepeatTimeType",(function(){return d})),n.d(t,"Week",(function(){return s})),n.d(t,"ActionType",(function(){return u})),n.d(t,"CommandType",(function(){return p}));var a=n("5530"),i=(n("7db0"),n("d3b7"),n("b64b"),n("b0c0"),n("38cf"),n("25f0"),n("159b"),n("e9c4"),n("a9e3"),n("a15b"),n("ac1f"),n("1276"),{device:"1",time:"2",getKey:function(e){return Object.keys(i).find((function(t){return i[t]===e}))}}),r={property:"1",event:"2",onlineState:"3",onlineDuration:"4",getKey:function(e){return Object.keys(r).find((function(t){return r[t]===e}))}},o={online:"1",offline:"2",onAndOff:"3",getKey:function(e){return Object.keys(o).find((function(t){return o[t]===e}))}},c={range:"0",once:"1",repeat:"2",custom:"3",getKey:function(e){return Object.keys(c).find((function(t){return c[t]===e}))}},d={perHour:"1",days:"2",weekly:"3",monthly:"4",cron:"5",getKey:function(e){return Object.keys(d).find((function(t){return d[t]===e}))}},s={SUNDAY:1,MONDAY:2,TUESDAY:3,WEDNESDAY:4,THURSDAY:5,FRIDAY:6,SATURDAY:7},u={device:"1",alarm:"2",scene:"3",getKey:function(e){return Object.keys(u).find((function(t){return u[t]===e}))}},p={property:1,service:2};function y(e){var t=1,n=function(e){var n={};if(console.log("Object.keys(c)",e),"device"===e.type)n={condition_type:i.device,device_id:e.data.deviceId,device_condition_type:r[e.data.state.mode]},n.device_condition_type===r.property?(n["v1"]=e.data.state.name,n["v2"]=e.data.state.operator.symbol,n["v3"]=e.data.state.operator.value):n.device_condition_type===r.onlineState&&(n["v2"]=o[e.data.state.name]);else if("time"===e.type){switch(console.log("时间条件",e),n={condition_type:i.time,time_condition_type:c[e.data.type]},n.time_condition_type){case c.once:n["v1"]=e.data.once.value;break;case c.repeat:var a=e.data.repeat;switch(n["v1"]=d[a.type].toString(),d[a.type]){case d.perHour:n["v3"]=a.perHour.toString();break;case d.days:n["v3"]=a.days.toString();break;case d.weekly:var s=a.weekly.week;n["v3"]=s.toString(),n["v4"]=a.weekly.time.toString();break;case d.monthly:n["v3"]=a.monthly.day.toString()+":"+a.monthly.time.toString();break;case d.cron:n["v3"]=a.cron.toString()}break;case c.range:n["v1"]=e.data.range[0],n["v2"]=e.data.range[1];break}console.log("setConditions",n)}return e.relation&&"or"==e.relation&&t++,n.group_number=t,n},a=[];return e.length>0&&e.forEach((function(e){a.push(n(e))})),a}function v(e,t){var n=function(e){var n={};switch(n.action_type=u[e.type],console.log("====washAction",e,n),n.action_type){case u.device:e.data.forEach((function(e){var t={};t[e.state.name]=e.state.operator.value;var r={device_model:"1",instruct:t};i.push(Object(a["a"])(Object(a["a"])({},n),{},{device_id:e.deviceId,additional_info:JSON.stringify(r)}))}));break;case u.scene:n.scenario_strategy_id=e.value||"",i.push(n);break;case u.alarm:n.warning_strategy={},n.warning_strategy.id=e.data.id?e.data.id:"",n.warning_strategy.warning_strategy_name=t,n.warning_strategy.warning_level=e.data.warningLevel,n.warning_strategy.group=e.data.group,n.warning_strategy.repeat_count=Number(e.data.repeatTimes),n.warning_strategy.inform_way=e.data.notification.join(","),n.warning_strategy.warning_description=e.data.warning_description,i.push(n);break}},i=[];return e.length>0&&e.forEach((function(e){n(e)})),i}function g(e){var t=[],n=1;return console.log("getConditions",e),e&&e.length>0?e.forEach((function(e,a){console.log(a,e.group_number);var s=e.group_number,u={};if(0===a?u.relation="":s===n?u.relation="and":s>n&&(u.relation="or",n=s),e.condition_type==i.device){u.type=i.getKey(e.condition_type),u.data={projectId:e.business_id,groupId:e.asset_id,deviceId:e.device_id};var p="";switch(e.device_condition_type){case r.property:p=e.v1;break;case r.onlineState:p=o.getKey(e.v2);break}console.log(u.data.state),u.data.state={name:p,mode:r.getKey(e.device_condition_type),operator:{symbol:e.v2,value:e.v3}}}else switch(u.type=i.getKey(e.condition_type),u.data={type:c.getKey(e.time_condition_type)},e.time_condition_type){case c.once:u.data.once={value:e.v1};break;case c.repeat:switch(u.data.repeat={type:d.getKey(e.v1)},e.v1){case d.perHour:u.data.repeat.perHour=e.v3;break;case d.days:u.data.repeat.days=e.v3;break;case d.weekly:u.data.repeat.weekly={week:e.v3,time:e.v4};break;case d.monthly:var y=e.v3.split(":");u.data.repeat.monthly={day:y[0],time:y[1]+":"+y[2]};break;case d.cron:u.data.repeat.cron=e.v3;break}break;case c.range:u.data.range=[e.v1,e.v2];break;case c.custom:break}t.push(u)})):t.push({}),t}function l(e){var t=[],n=[];return e.forEach((function(e){var a={};if(e.action_type===u.device){var i={projectId:e.business_id,groupId:e.asset_id,deviceId:e.device_id,state:{}},r=e.additional_info?JSON.parse(e.additional_info):{},o=Object.keys(r.instruct||{})[0];i.state={name:o,mode:"property",operator:{symbol:"",value:r.instruct?r.instruct[o]:""}},n.push(i)}else if(e.action_type===u.alarm){var c,d,s,p,y;a.type="alarm",a.data={id:(null===(c=e.warning_strategy)||void 0===c?void 0:c.id)||"",warningLevel:(null===(d=e.warning_strategy)||void 0===d?void 0:d.warning_level)||"",repeatTimes:(null===(s=e.warning_strategy)||void 0===s?void 0:s.repeat_count)||0,notification:(null===(p=e.warning_strategy)||void 0===p?void 0:p.inform_way.split(","))||[],warning_description:(null===(y=e.warning_strategy)||void 0===y?void 0:y.warning_description)||""},t.push(a)}else e.action_type===u.scene&&(a.type="scene",a.value=e.scenario_strategy_id,t.push(a))})),n.length>0&&t.push({type:"device",data:n}),console.log("getActions.actionList",t),t}}}]);