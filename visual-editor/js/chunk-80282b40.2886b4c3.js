(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-80282b40","chunk-26cac7dd","chunk-227ff34f","chunk-2b886370"],{1646:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"el-dark-dialog",attrs:{"close-on-click-modal":!1,"before-close":t.handleClose,visible:t.apiDialogVisible,width:"40%",height:"60%",top:"10vh"},on:{"update:visible":function(e){t.apiDialogVisible=e}}},[a("div",{staticClass:"rounded p-4 card"},[a("el-row",{staticClass:"pt-3 pb-4 px-3",attrs:{type:"flex",gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-select",{staticClass:"el-dark-input",staticStyle:{width:"20%","margin-right":"10px"},attrs:{"no-data-text":t.$t("COMMON.SELECT_NO_DATA"),"value-key":"value",placeholder:"未添加"},on:{change:t.handleIsAddChange},model:{value:t.formData.isAdd,callback:function(e){t.$set(t.formData,"isAdd",e)},expression:"formData.isAdd"}},t._l(t.isAddOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t}})})),1),a("el-select",{ref:"projectRef",staticStyle:{width:"20%","margin-right":"10px"},attrs:{"no-data-text":t.$t("COMMON.SELECT_NO_DATA"),placeholder:t.$t("AUTOMATION.PLACEHOLDER.SELECT_PROJECT"),clearable:"","value-key":"id"},on:{change:t.handleProjectChange},model:{value:t.formData.projectId,callback:function(e){t.$set(t.formData,"projectId",e)},expression:"formData.projectId"}},t._l(t.projectOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),a("el-select",{ref:"groupRef",staticStyle:{width:"20%","margin-right":"10px"},attrs:{"no-data-text":t.$t("COMMON.SELECT_NO_DATA"),clearable:"",placeholder:t.$t("AUTOMATION.PLACEHOLDER.SELECT_GROUP")},on:{change:t.handleGroupChange},model:{value:t.formData.groupId,callback:function(e){t.$set(t.formData,"groupId",e)},expression:"formData.groupId"}},t._l(t.groupOptions,(function(t,e){return a("el-option",{key:e,attrs:{label:t.device_group,value:t.id}})})),1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.listData}},[a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.DEVICE_NAME"),prop:"device_name",width:"160px"}}),a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.PROJECT_NAME"),prop:"business_name",width:"160px"}}),a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.GROUP_NAME"),prop:"asset_name",width:"160px"}}),a("el-table-column",{attrs:{prop:"actions",label:t.$t("RULE_ENGINE.DATA_GATEWAY.OPERATION"),align:"left",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==t.formData.isAdd.value?a("el-button",{attrs:{size:"mini",type:"indigo"},on:{click:function(a){return t.handleAddRelationship(e.row)}}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.ADD")))]):t._e(),1==t.formData.isAdd.value?a("el-button",{attrs:{size:"mini",type:"indigo"},on:{click:function(a){return t.handleDeleteRelationship(e.row)}}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.DELETE")))]):t._e()]}}])})],1),a("div",{staticClass:"text-right py-3"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:t.data_count,"current-page":t.page,"page-size":t.page_size},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.page_change}})],1),a("div",[a("el-button",{attrs:{size:"mini",type:"indigo"},on:{click:t.handleClose}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.CLOSE")))])],1)],1)])},s=[],n=a("d956"),o=a("2b6d"),l=a("308f"),r=a("f570"),c={name:"DeviceAccessScopeForm",props:{id:{default:null},data:{default:null},visible:{type:[Boolean],default:!1},initForm:{isAdd:{name:r["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_NOT_ADDED"),value:0},projectId:"",groupId:"",deviceId:"",device:{},state:{duration:{},operator:{symbol:"",value:""}}}},computed:{apiDialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},watch:{visible:{handler:function(t){t&&this.id&&(this.loading=!0,this.page=1,this.get_device_data(),this.data_count=this.listData.length,this.getProjectChoice())}}},data:function(){return{signMethodChoice:["MD5","HAS256"],apiAccessScopeChoice:[{name:r["a"].t("RULE_ENGINE.DATA_GATEWAY.ALL"),value:1},{name:r["a"].t("RULE_ENGINE.DATA_GATEWAY.PART"),value:2}],deviceAccessScopeChoice:[{name:r["a"].t("RULE_ENGINE.DATA_GATEWAY.ALL"),value:1},{name:r["a"].t("RULE_ENGINE.DATA_GATEWAY.PART"),value:2}],isAddOptions:[{name:r["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_NOT_ADDED"),value:0},{name:r["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_ADDED"),value:1}],projectOptions:[],groupOptions:[],listData:[],addedDeviceIdList:[],loading:!1,page:0,page_size:5,data_count:0,formData:{isAdd:{name:r["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_NOT_ADDED"),value:0},projectId:"",groupId:"",deviceId:"",device:{},state:{duration:{},operator:{symbol:"",value:""}}}}},methods:{get_device_data:function(){var t=this,e={current_page:this.page,per_page:this.page_size,tp_openapi_auth_id:this.id,is_add:this.formData.isAdd.value,business_id:this.formData.projectId,asset_id:this.formData.groupId};Object(n["f"])(e).then((function(e){200==e.data.code&&(t.listData=e.data.data.data,t.data_count=e.data.data.total,t.loading=!1)}))},page_change:function(t){this.loading=!0,this.page=t,this.get_device_data()},handleClose:function(){this.page=1,this.formData={isAdd:{name:r["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_NOT_ADDED"),value:0},projectId:"",groupId:"",deviceId:"",device:{},state:{duration:{},operator:{symbol:"",value:""}}},this.listData=[],this.apiDialogVisible=!1},cancelDialog:function(){this.page=1,this.formData={isAdd:{name:r["a"].t("RULE_ENGINE.DATA_GATEWAY.MSG_NOT_ADDED"),value:0},projectId:"",groupId:"",deviceId:"",device:{},state:{duration:{},operator:{symbol:"",value:""}}},this.listData=[],this.apiDialogVisible=!1},handleDeleteRelationship:function(t){var e=this;this.loading=!0;var a={tp_openapi_auth_id:this.id,device_id:t.device_id};Object(n["c"])(a).then((function(t){var a=t.data;200==a.code&&e.$message({message:r["a"].t("COMMON.DELETE_SUCCESS"),center:!0,type:"success"}),e.loading=!1})),this.get_device_data()},handleAddRelationship:function(t){var e=this;this.loading=!0;var a={tp_openapi_auth_id:this.id,device_id:t.device_id};Object(n["a"])(a).then((function(t){var a=t.data;200==a.code&&e.$message({message:r["a"].t("COMMON.ADD_SUCCESS"),center:!0,type:"success"}),e.loading=!1,e.get_device_data()}))},getProjectChoice:function(){var t=this;Object(o["d"])({limit:100,page:1}).then((function(e){var a=e.data;200==a.code&&(t.projectOptions=a.data?a.data.data:[])}))},getGroupList:function(t){var e=this;Object(l["i"])({business_id:t}).then((function(t){var a=t.data;200==a.code&&(e.groupOptions=(null===a||void 0===a?void 0:a.data)||[])}))},handleProjectChange:function(t){this.loading=!0,this.page=1,this.formData.projectId=t,this.formData.groupId="",this.get_device_data(),t&&this.getGroupList(t)},handleGroupChange:function(t){this.page=1,this.loading=!0,this.formData.groupId=t,this.get_device_data()},handleIsAddChange:function(t){this.loading=!0,this.page=1,this.formData.isAdd=t,this.get_device_data()},validate:function(){return!0}}},d=c,u=(a("72ff"),a("2877")),p=Object(u["a"])(d,i,s,!1,null,"4e0d005b",null);e["default"]=p.exports},"1e78":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"el-dark-dialog",attrs:{title:t.id?t.$t("RULE_ENGINE.DATA_GATEWAY.EDIT"):t.$t("RULE_ENGINE.DATA_GATEWAY.CREATE"),"close-on-click-modal":!1,"before-close":t.handleClose,visible:t.apiDialogVisible,width:"40%",height:"60%",top:"10vh"},on:{"update:visible":function(e){t.apiDialogVisible=e}}},[a("div",{staticClass:"rounded p-4 card"},[a("el-row",{staticClass:"pt-3 pb-4 px-3",attrs:{type:"flex",gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-select",{staticClass:"el-dark-input",staticStyle:{width:"20%"},attrs:{placeholder:t.$t("COMMON.ALL")}}),a("el-input",{staticStyle:{width:"20%","margin-left":"10px"},attrs:{placeholder:t.$t("RULE_ENGINE.DATA_GATEWAY.INTERFACE_NAME"),clearable:""},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"formTable",attrs:{data:t.filteredData},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",label:t.$t("RULE_ENGINE.DATA_GATEWAY.INTERFACE_NAME"),prop:"id"}}),a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.INTERFACE_NAME"),prop:"name"}}),a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.URL"),prop:"url"}}),a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.INTERFACE_TYPE"),prop:"api_type"}}),a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.INTERFACE_DESCRIPTION"),prop:"remark"}})],1),a("div",[a("div",[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.MSG_SELECTED"))+t._s(this.choosedCount)+t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.MSG_SELECTED_INTERFACE")))]),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{staticClass:"cancel-button",attrs:{type:"cancel",size:"medium",plain:""},on:{click:t.handleClose}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.CANCEL")))]),a("el-button",{staticClass:"medium",staticStyle:{"margin-left":"10px"},attrs:{type:"save",size:"medium"},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.SUBMIT")))])],1)])],1)])},s=[],n=(a("4de4"),a("d3b7"),a("caad"),a("2532"),a("159b"),a("d956")),o={name:"ApiAccessScopeForm",props:{id:{default:null},data:{default:[]},tableData:{default:null},keyword:{default:""},visible:{type:[Boolean],default:!1}},mounted:function(){var t=this;this.SelectionChange(),"el-select"===this.$options._componentTag&&(this.$el.setAttribute("no-data-text","someValue"),this.$el.setAttribute("noDataText","someValue"),this.$el.setAttribute("placeholder","someValue"),console.error(this.$el)),this.$nextTick((function(){t.$refs.aaaa.setAttribute("placeholder","someValue"),console.error(t.$refs.aaaa)}))},computed:{apiDialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},watch:{keyword:function(){var t=this,e=this.listData;this.keyword&&(e=e.filter((function(e){return e.interface_name.includes(t.keyword)}))),this.page=1,this.filteredData=e,this.data_count=e.length},visible:{handler:function(t){t&&this.id&&(this.loading=!0,this.page=1,this.get_interface_data(),this.data_count=this.filteredData.length)}}},data:function(){return{page:0,page_size:5,data_count:0,choosedCount:0,choosedIdList:[],loading:!1,listData:[],filteredData:[],form:{id:"",name:"",app_key:"",signature_mode:"",ip_whitelist:"",device_access_scope:0,api_access_scope:0,created_at:0,tenant_id:"",description:""}}},methods:{get_interface_data:function(){var t=this;Object(n["e"])(this.id).then((function(e){200==e.data.code&&(t.listData=e.data.data,t.data_count=e.data.data.length,t.listData&&(t.listData.forEach((function(e){-1==t.choosedIdList.indexOf(e.id)&&t.choosedIdList.push(e.id)})),t.choosedCount=t.choosedIdList.length),t.filteredData=t.listData,t.SelectionChange(),t.loading=!1)}))},handleSubmit:function(){var t=this;this.loading=!0;var e={tp_api_id:this.choosedIdList,tp_openapi_auth_id:this.id};Object(n["h"])(e).then((function(e){200==e.data.code&&t.$message({message:"变更成功",center:!0,type:"success"}),t.get_interface_data()})),this.page=1,this.keyword="",this.form={},this.listData=[],this.apiDialogVisible=!1},handleClose:function(){this.page=1,this.keyword="",this.form={},this.listData=[],this.apiDialogVisible=!1},handleSelectionChange:function(t){var e=this;this.choosedIdList=[],t.forEach((function(t){e.choosedIdList.push(t.id)})),this.choosedCount=this.choosedIdList.length},cancelDialog:function(){this.page=1,this.keyword="",this.form={},this.listData=[],this.apiDialogVisible=!1},SelectionChange:function(){var t=this;this.$nextTick((function(){var e=t.filteredData;e.forEach((function(e){1===e.is_add&&t.$refs.formTable.toggleRowSelection(e,!0)}))}))}}},l=o,r=(a("e66e"),a("2877")),c=Object(r["a"])(l,i,s,!1,null,"bdf4e9d4",null);e["default"]=c.exports},"239d":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h3",{staticClass:"table-title h3 font-weight-bolder m-0 pt-2"},[t._t("default")],2)},s=[],n={name:"TableTitle"},o=n,l=a("2877"),r=Object(l["a"])(o,i,s,!1,null,"2001a59c",null);e["a"]=r.exports},"2b6d":function(t,e,a){"use strict";a.d(e,"d",(function(){return s})),a.d(e,"a",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"b",(function(){return l}));var i=a("18a6");function s(t){return Object(i["a"])({url:"/business/index",method:"post",data:t})}function n(t){return Object(i["a"])({url:"/business/add",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/business/edit",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/business/delete",method:"post",data:t})}},"308f":function(t,e,a){"use strict";a.d(e,"c",(function(){return n})),a.d(e,"j",(function(){return o})),a.d(e,"d",(function(){return l})),a.d(e,"e",(function(){return r})),a.d(e,"f",(function(){return c})),a.d(e,"i",(function(){return d})),a.d(e,"g",(function(){return u})),a.d(e,"h",(function(){return p})),a.d(e,"a",(function(){return _})),a.d(e,"b",(function(){return h}));var i=a("5530"),s=(a("2ca0"),a("d3b7"),a("d81d"),a("18a6"));function n(){return Object(s["a"])({url:"/asset/index",method:"post"})}function o(t){return Object(s["a"])({url:"/structure/field",method:"post",data:t})}function l(t){return Object(s["a"])({url:"/asset/list",method:"post",data:t})}function r(t){return Object(s["a"])({url:"/asset/list/a",method:"post",data:t})}function c(t){return Object(s["a"])({url:"/asset/list/b",method:"post",data:t})}function d(t){var e=function(t){return t&&t.startsWith("/")?t.substring(1):t};return new Promise((function(a,i){Object(s["a"])({url:"/asset/list/d",method:"post",data:t}).then((function(t){var i=t.data.data.map((function(t){return t.device_group=e(t.device_group),t}));t.data.data=i,a(t)})).catch((function(t){i(t)}))}))}function u(t){return Object(s["a"])({url:"/asset/list/c",method:"post",data:t})}function p(t){return Object(s["a"])({url:"/asset/update_only",method:"post",data:t})}function _(t){return Object(s["a"])({url:"/asset/add_only",method:"post",data:t})}function h(t){return Object(s["a"])({url:"/asset/delete",method:"post",data:Object(i["a"])({type:1},t)})}},"3cfe":function(t,e,a){"use strict";a("a9e3"),a("d3b7"),a("25f0");var i=a("2b0e");i["default"].mixin({methods:{formatDate:function(t){var e=1e3*parseInt(t),a=new Date(e),i=a.getFullYear(),s=a.getMonth()+1;s=s<10?"0"+s:s;var n=a.getDate();n=n<10?"0"+n:n;var o=a.getHours();o=o<10?"0"+o:o;var l=a.getMinutes();l=l<10?"0"+l:l;var r=a.getSeconds();r=r<10?"0"+r:r;var c=i+"-"+s+"-"+n+" "+o+":"+l+":"+r;return c},jsonTypeConvert:function(t,e){var a=(null===t||void 0===t?void 0:t.toLowerCase())||"";return"float"===a||"integer"===a||"number"===a?Number(e):e.toString()}}})},5517:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"el-dark-dialog",attrs:{title:t.id?t.$t("RULE_ENGINE.DATA_GATEWAY.EDIT"):t.$t("RULE_ENGINE.DATA_GATEWAY.CREATE"),"close-on-click-modal":!1,"before-close":t.handleClose,visible:t.dataGatewayDialogVisible,width:"30%",height:"60%",top:"10vh"},on:{"update:visible":function(e){t.dataGatewayDialogVisible=e}}},[a("el-form",{ref:"CreateForm",staticStyle:{"margin-left":"5%"},attrs:{"label-position":"left","label-width":"140px",model:t.form}},[a("el-form-item",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.NAME"),required:""}},[a("el-col",{attrs:{span:20}},[a("el-input",{ref:"nameRef",model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),a("el-form-item",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.SIGNATURE_MODE"),required:""}},[a("el-col",{attrs:{span:20}},[a("el-select",{ref:"signatureModeRef",staticClass:"el-dark-input",staticStyle:{width:"100%"},attrs:{"no-data-text":t.$t("COMMON.SELECT_NO_DATA")},model:{value:t.form.signature_mode,callback:function(e){t.$set(t.form,"signature_mode",e)},expression:"form.signature_mode"}},t._l(t.signMethodChoice,(function(t){return a("el-option",{key:t,staticClass:"el-dark-input",attrs:{label:t,value:t}})})),1)],1)],1),a("el-form-item",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.IP_WHITELIST")}},[a("el-col",{attrs:{span:20}},[a("el-input",{ref:"IPRef",staticClass:"el-dark-input",attrs:{type:"textarea",rows:"4",placeholder:t.$t("RULE_ENGINE.DATA_GATEWAY.MSG_IP_FORMAT")},model:{value:t.form.ip_whitelist,callback:function(e){t.$set(t.form,"ip_whitelist",e)},expression:"form.ip_whitelist"}})],1)],1),a("el-form-item",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.DEVICE_ACCESS_SCOPE"),required:""}},[a("el-col",{attrs:{span:20}},[a("el-select",{ref:"deviceAccessScopeRef",staticClass:"el-dark-input",staticStyle:{width:"100%"},attrs:{"no-data-text":t.$t("COMMON.SELECT_NO_DATA")},model:{value:t.form.device_access_scope,callback:function(e){t.$set(t.form,"device_access_scope",e)},expression:"form.device_access_scope"}},t._l(t.deviceAccessScopeChoice,(function(t){return a("el-option",{key:t.value,staticClass:"el-dark",attrs:{label:t.name,value:t.value}})})),1)],1)],1),a("el-form-item",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.API_ACCESS_SCOPE"),required:""}},[a("el-col",{attrs:{span:20}},[a("el-select",{ref:"apiAccessScopeRef",staticClass:"el-dark-input",staticStyle:{width:"100%"},attrs:{"no-data-text":t.$t("COMMON.SELECT_NO_DATA")},model:{value:t.form.api_access_scope,callback:function(e){t.$set(t.form,"api_access_scope",e)},expression:"form.api_access_scope"}},t._l(t.apiAccessScopeChoice,(function(t){return a("el-option",{key:t.value,staticClass:"el-dark-input",attrs:{label:t.name,value:t.value}})})),1)],1)],1),a("el-form-item",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.DESCRIPTION")}},[a("el-col",{attrs:{span:20}},[a("el-input",{ref:"descRef",staticClass:"el-dark-input",attrs:{type:"textarea"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1),a("div",{staticStyle:{display:"flex","justify-content":"center"}},[a("el-button",{staticClass:"cancel-button",attrs:{type:"cancel",size:"medium",plain:""},on:{click:t.cancelDialog}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.CANCEL")))]),a("el-button",{staticClass:"medium",staticStyle:{"margin-left":"10px"},attrs:{type:"save",size:"medium"},on:{click:t.onSubmit}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.SUBMIT")))])],1)],1)],1)},s=[],n=(a("e9c4"),a("b0c0"),a("ac1f"),a("00b4"),a("d956")),o=a("2fa3"),l={name:"CreateForm",props:{id:{default:null},data:{default:null},visible:{type:[Boolean],default:!1}},computed:{dataGatewayDialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},watch:{visible:{handler:function(t){t&&this.id&&(this.form=this.data)}}},data:function(){return{signMethodChoice:["MD5","HAS256"],apiAccessScopeChoice:[{name:this.$t("RULE_ENGINE.DATA_GATEWAY.ALL"),value:"1"},{name:this.$t("RULE_ENGINE.DATA_GATEWAY.PART"),value:"2"}],deviceAccessScopeChoice:[{name:this.$t("RULE_ENGINE.DATA_GATEWAY.ALL"),value:"1"},{name:this.$t("RULE_ENGINE.DATA_GATEWAY.PART"),value:"2"}],listData:[],form:{id:"",name:"",signature_mode:"",ip_whitelist:"",device_access_scope:"1",api_access_scope:"1",created_at:0,description:""}}},methods:{onSubmit:function(){var t=this;if(this.validate()){var e=JSON.parse(JSON.stringify(this.form));this.id?Object(n["i"])(e).then((function(e){200===e.data.code&&(t.$emit("submit"),t.listData=[],t.dataGatewayDialogVisible=!1,t.$message({message:t.$t("COMMON.EDIT_SUCCESS"),center:!0,type:"success"}))})):Object(n["b"])(e).then((function(e){200===e.data.code&&(t.$emit("submit"),t.listData=[],t.dataGatewayDialogVisible=!1,t.$message({message:t.$t("COMMON.ADD_SUCCESS"),center:!0,type:"success"}))})),this.form={}}},handleClose:function(){this.form={},this.listData=[],this.dataGatewayDialogVisible=!1},cancelDialog:function(){this.form={},this.listData=[],this.dataGatewayDialogVisible=!1},validate:function(){var t=/^(?:(?:^|\|)(?:[0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(?:\.(?:[0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3})+$/;return this.form.name&&""!=this.form.name?this.form.signature_mode&&""!=this.form.signature_mode?this.form.ip_whitelist&&!t.test(this.form.ip_whitelist)?(Object(o["h"])(this.$t("RULE_ENGINE.DATA_GATEWAY.MSG_IP_ERROR")),!1):this.form.device_access_scope&&""!=this.form.device_access_scope?!(!this.form.api_access_scope||""==this.form.api_access_scope)||(this.$refs.apiAccessScopeRef.focus(),Object(o["h"])(this.$t("RULE_ENGINE.DATA_GATEWAY.请选择接口接入范围")),!1):(this.$refs.deviceAccessScopeRef.focus(),Object(o["h"])(this.$t("RULE_ENGINE.DATA_GATEWAY.MSG_DEVICE_ACCESS_SCOPE_ERROR")),!1):(this.$refs.signatureModeRef.focus(),Object(o["h"])(this.$t("RULE_ENGINE.DATA_GATEWAY.MSG_SIGNATURE_MODE_ERROR")),!1):(this.$refs.nameRef.focus(),Object(o["h"])(this.$t("RULE_ENGINE.DATA_GATEWAY.MSG_NAME_ERROR")),!1)}}},r=l,c=(a("bb3a"),a("2877")),d=Object(c["a"])(r,i,s,!1,null,"3ec69592",null);e["default"]=d.exports},"72ff":function(t,e,a){"use strict";a("ecd6")},"76a5a":function(t,e,a){},"8a72":function(t,e,a){},a1b8:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rounded p-4 card"},[a("el-row",{staticClass:"pt-3 pb-4 px-3",attrs:{type:"flex",gutter:20}},[a("el-col",{attrs:{span:12}},[a("TableTitle",[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.DATA_GATEWAY")))])],1),a("el-col",{staticClass:"px-2 text-right",attrs:{span:12}},[a("el-button",{attrs:{size:"medium",type:"border"},on:{click:t.handleCreate}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.CREATE")))])],1)],1),a("el-row",{staticStyle:{"margin-bottom":"5px"}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:t.$t("RULE_ENGINE.DATA_GATEWAY.NAME"),size:"medium",clearable:""},on:{input:t.handleSearch},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}})],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableData},scopedSlots:t._u([{key:"empty",fn:function(){return[a("div",[t._v(t._s(t.$t("COMMON.TABLE_NO_DATA")))])]},proxy:!0}])},[a("el-table-column",{attrs:{label:t.$t("RULE_ENGINE.DATA_GATEWAY.NAME"),prop:"name","min-width":"150"}}),a("el-table-column",{attrs:{prop:"app_key",label:t.$t("RULE_ENGINE.DATA_GATEWAY.APP_KEY"),"min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-col",[a("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.row.app_key,expression:"scope.row.app_key",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.handleCopy,expression:"handleCopy",arg:"success"}],staticClass:"el-icon-document-copy",staticStyle:{"margin-right":"5px",cursor:"pointer"}}),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.app_key,placement:"top-start"}},[a("span",[t._v(t._s(e.row.app_key?e.row.app_key.substr(0,5)+"...":""))])])],1)],1)]}}])}),a("el-table-column",{attrs:{prop:"signature_mode",label:t.$t("RULE_ENGINE.DATA_GATEWAY.SIGNATURE_MODE"),width:"90"}}),a("el-table-column",{attrs:{prop:"ip_whitelist",label:t.$t("RULE_ENGINE.DATA_GATEWAY.IP_WHITELIST"),"min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.ip_whitelist,placement:"top-start",width:"110"}},[a("span",[t._v(t._s(e.row.ip_whitelist&&e.row.ip_whitelist.length>24?e.row.ip_whitelist.substr(0,24)+"...":e.row.ip_whitelist))])])]}}])}),a("el-table-column",{attrs:{prop:"device_access_scope",label:t.$t("RULE_ENGINE.DATA_GATEWAY.DEVICE_ACCESS_SCOPE"),span:12,"min-width":"125"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.device_access_scope?a("span",[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.ALL")))]):"2"==e.row.device_access_scope?a("span",[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.PART")))]):a("span",[t._v("error")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"1"!=e.row.device_access_scope?"success":"info",disabled:"1"==e.row.device_access_scope},on:{click:function(a){return t.handleShowDeviceDialog(e.row)}}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.CHOOSE")))])]}}])}),a("el-table-column",{attrs:{prop:"api_access_scope",label:t.$t("RULE_ENGINE.DATA_GATEWAY.API_ACCESS_SCOPE"),"min-width":"125"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.api_access_scope?a("span",[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.ALL")))]):"2"==e.row.api_access_scope?a("span",[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.PART")))]):a("span",[t._v("error")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"1"!=e.row.api_access_scope?"success":"info",disabled:"1"==e.row.api_access_scope},on:{click:function(a){return t.handleShowApiDialog(e.row)}}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.CHOOSE")))])]}}])}),a("el-table-column",{attrs:{prop:"description",label:t.$t("RULE_ENGINE.DATA_GATEWAY.DESCRIPTION")}}),a("el-table-column",{attrs:{prop:"created_at",label:t.$t("RULE_ENGINE.DATA_GATEWAY.CREATED_AT"),width:"145"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.formatDate(e.row.created_at))+" ")]}}])}),a("el-table-column",{attrs:{prop:"actions",label:t.$t("RULE_ENGINE.DATA_GATEWAY.OPERATION"),align:"left",width:"245px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"indigo"},on:{click:function(a){return t.handleShowKey(e.row)}}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.VIEW_KEY")))]),a("el-button",{staticClass:"mr-3",attrs:{size:"mini",type:"indigo"},on:{click:function(a){return t.handleShowEdit(e.row)}}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.EDIT")))]),a("el-popconfirm",{staticClass:"mr-1",attrs:{"confirm-button-text":t.$t("COMMON.CONFIRM"),"cancel-button-text":t.$t("COMMON.CANCEL"),title:t.$t("AUTOMATION.TITLE4")},on:{confirm:function(a){return t.handle_del(e.row.id)}}},[a("el-button",{staticClass:"mr-3",attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.DELETE")))])],1)]}}])})],1),a("div",{staticClass:"text-right py-3"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.data_count,"current-page":t.page,"page-size":t.per_page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.page_change}})],1),a("CreateForm",{attrs:{visible:t.dataGatewayDialogVisible,data:t.formData,id:t.formId},on:{"update:visible":function(e){t.dataGatewayDialogVisible=e},submit:t.get_data}}),a("ApiAccessScopeForm",{attrs:{visible:t.apiDialogVisible,data:t.formData,id:t.formId},on:{"update:visible":function(e){t.apiDialogVisible=e},submit:t.get_data}}),a("DeviceAccessScopeForm",{attrs:{visible:t.deviceDialogVisible,data:t.formData,id:t.formId,loading:t.loading},on:{"update:visible":function(e){t.deviceDialogVisible=e},submit:t.get_data}}),a("el-dialog",{attrs:{visible:t.viewKeyDialogVisible,width:"35%",height:"60%",title:t.$t("RULE_ENGINE.DATA_GATEWAY.VIEW_KEY"),"before-close":t.handleCloseViewKey}},[a("el-row",{staticClass:"pt-3 pb-4 px-3",attrs:{type:"flex",gutter:20}},[a("el-col",{attrs:{span:3}},[t._v(" "+t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.SECRET_KEY"))+": ")]),a("el-col",{attrs:{span:18}},[t._v(" "+t._s(this.viewSecretKey)+" ")]),a("el-col",{attrs:{span:3}},[a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.viewSecretKey,expression:"viewSecretKey",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.handleCopy,expression:"handleCopy",arg:"success"}],attrs:{size:"mini",type:"success",width:"30px"}},[t._v(t._s(t.$t("RULE_ENGINE.DATA_GATEWAY.COPY")))])],1)],1)],1)],1)},s=[],n=a("1e78"),o=a("1646"),l=a("5517"),r=a("239d"),c=a("d956"),d=(a("3cfe"),{name:"DataGateway",components:{CreateForm:l["default"],TableTitle:r["a"],ApiAccessScopeForm:n["default"],DeviceAccessScopeForm:o["default"]},data:function(){return{dataGatewayDialogVisible:!1,apiDialogVisible:!1,deviceDialogVisible:!1,viewKeyDialogVisible:!1,viewAppKey:null,viewSecretKey:null,searchName:"",formId:"",formData:null,loading:!1,per_page:5,page:1,data_count:2,tableData:[]}},created:function(){this.get_data()},methods:{get_data:function(){var t=this,e={current_page:this.page,per_page:this.per_page};Object(c["g"])(e).then((function(e){200==e.data.code&&(t.tableData=e.data.data.data,t.data_count=e.data.data.total,t.loading=!1)}))},page_change:function(t){this.loading||(this.loading=!0,this.page=t,this.get_data())},handleCopy:function(){this.$message.success("复制成功！")},handle_del:function(t){var e=this;Object(c["d"])({id:t}).then((function(t){200===t.data.code&&(e.get_data(),e.$message({message:"删除成功",center:!0,type:"success"}))}))},handleSearch:function(t){var e=this;this.page=1;var a={current_page:this.page,per_page:this.per_page,name:t};Object(c["g"])(a).then((function(t){200==t.data.code&&(e.tableData=t.data.data.data,e.data_count=t.data.data.total,e.loading=!1)}))},handleCreate:function(){this.formId="",this.dataGatewayDialogVisible=!0},handleShowKey:function(t){this.viewKeyDialogVisible=!0,this.viewAppKey=t.app_key,this.viewSecretKey=t.secret_key},handleCloseViewKey:function(){this.viewKeyDialogVisible=!1,this.viewAppKey="",this.viewSecretKey=""},handleShowEdit:function(t){this.formId=t.id,this.formData=t,this.dataGatewayDialogVisible=!0},handleShowApiDialog:function(t){this.formId=t.id,this.formData=t,this.apiDialogVisible=!0},handleShowDeviceDialog:function(t){this.formId=t.id,this.formData=t,this.deviceDialogVisible=!0}}}),u=d,p=a("2877"),_=Object(p["a"])(u,i,s,!1,null,"2001cdf0",null);e["default"]=_.exports},bb3a:function(t,e,a){"use strict";a("8a72")},d956:function(t,e,a){"use strict";a.d(e,"g",(function(){return s})),a.d(e,"b",(function(){return n})),a.d(e,"i",(function(){return o})),a.d(e,"d",(function(){return l})),a.d(e,"e",(function(){return r})),a.d(e,"h",(function(){return c})),a.d(e,"f",(function(){return d})),a.d(e,"a",(function(){return u})),a.d(e,"c",(function(){return p}));var i=a("18a6");function s(t){return Object(i["a"])({url:"/openapi/auth/list",method:"post",data:t})}function n(t){return Object(i["a"])({url:"/openapi/auth/add",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/openapi/auth/edit",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/openapi/auth/del",method:"post",data:t})}function r(t){return Object(i["a"])({url:"/openapi/api/list",method:"post",data:{tp_openapi_auth_id:t,current_page:1,per_page:1e4,name:"",api_type:"",service_type:""}})}function c(t){return Object(i["a"])({url:"/openapi/rapi/edit",method:"post",data:t})}function d(t){return Object(i["a"])({url:"/device/business/asset/permissions",method:"post",data:t})}function u(t){return Object(i["a"])({url:"/openapi/rdevice/add",method:"post",data:t})}function p(t){return Object(i["a"])({url:"/openapi/rdevice/del",method:"post",data:t})}},e66e:function(t,e,a){"use strict";a("76a5a")},ecd6:function(t,e,a){}}]);