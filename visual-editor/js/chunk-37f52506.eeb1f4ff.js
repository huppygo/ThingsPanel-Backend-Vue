(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37f52506"],{"1b2c":function(t,a,e){"use strict";e("339b")},"239d":function(t,a,e){"use strict";var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("h3",{staticClass:"table-title h3 font-weight-bolder m-0 pt-2"},[t._t("default")],2)},r=[],i={name:"TableTitle"},o=i,s=e("2877"),l=Object(s["a"])(o,n,r,!1,null,"2001a59c",null);a["a"]=l.exports},"339b":function(t,a,e){},"3a0e":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"rounded card p-4"},[e("el-row",{staticClass:"pt-3 pb-4 px-3",attrs:{type:"flex",gutter:20}},[e("el-col",{attrs:{span:12}},[e("TableTitle",[t._v(t._s(t.$t("VISUALIZATION.TITLE")))])],1),e("el-col",{staticClass:"px-2 text-right",attrs:{span:12}},[e("el-button",{attrs:{size:"medium",type:"border"},on:{click:function(a){return t.handleCreate()}}},[t._v(t._s(t.$t("VISUALIZATION.NEWVISUALIZATION")))])],1)],1),e("el-form",{staticClass:"inline-edit"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableData},scopedSlots:t._u([{key:"empty",fn:function(){return[e("div",[t._v(t._s(t.$t("COMMON.TABLE_NO_DATA")))])]},proxy:!0}])},[e("el-table-column",{attrs:{label:t.$t("VISUALIZATION.NO"),type:"index",align:"left","min-width":"110",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(10*(t.params.current_page-1)+a.$index+1))])]}}])}),e("el-table-column",{attrs:{label:t.$t("VISUALIZATION.VISUALIZATIONNAME"),prop:"dashboard_name",align:"left"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.status?e("el-form-item",{attrs:{error:a.row.errors.dashboard_name}},[e("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{size:"medium"},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.handleSave(a.row))}},model:{value:a.row.formData.dashboard_name,callback:function(e){t.$set(a.row.formData,"dashboard_name",e)},expression:"scope.row.formData.dashboard_name"}})],1):e("div",{staticClass:"w-100 cursor-pointer",on:{click:function(e){return t.showDeviceChart(a.row)}}},[e("p",{staticClass:"mad"},[t._v(t._s(a.row.dashboard_name))])])]}}])}),e("el-table-column",{attrs:{align:"left",label:t.$t("VISUALIZATION.OPERATION"),width:"230"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticStyle:{"text-align":"left"}},[a.row.status?e("div",[e("el-button",{attrs:{type:"save",size:"mini"},on:{click:function(e){return t.handleSave(a.row)}}},[t._v(t._s(t.$t("VISUALIZATION.SAVE")))]),e("el-button",{attrs:{type:"cancel",size:"mini"},on:{click:function(e){return t.handleCancel(a.row)}}},[t._v(t._s(t.$t("VISUALIZATION.CANCEL")))])],1):e("div",[e("el-button",{attrs:{type:"yellow",size:"mini"},on:{click:function(e){return t.showVisual(a.row)}}},[t._v(t._s(t.$t("VISUALIZATION.VIEW")))]),e("el-button",{attrs:{type:"indigo",size:"mini"},on:{click:function(e){return t.editVisual(a.row)}}},[t._v(t._s(t.$t("VISUALIZATION.EDIT")))]),e("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{"confirm-button-text":t.$t("COMMON.CONFIRM"),"cancel-button-text":t.$t("COMMON.CANCEL"),disabled:!t.hasAuth("visual:del"),title:t.$t("VISUALIZATION.TEXT44")},on:{confirm:function(e){return t.delVisual(a.row)}}},[e("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[t._v(t._s(t.$t("VISUALIZATION.DELETE")))])],1)],1)])]}}])})],1)],1),e("div",{staticClass:"text-right py-3"},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"current-page":t.params.current_page,"page-size":t.params.per_page},on:{"update:currentPage":function(a){return t.$set(t.params,"current_page",a)},"update:current-page":function(a){return t.$set(t.params,"current_page",a)},"current-change":t.getVisualList}})],1)],1)},r=[],i=(e("498a"),e("a434"),e("d3b7"),e("99af"),e("239d")),o=e("2fa3"),s=e("18a6"),l={add:function(t){return Object(s["a"])({url:"/tp_dashboard/add",method:"post",data:t})},list:function(t){return Object(s["a"])({url:"/tp_dashboard/list",method:"post",data:t})},edit:function(t){return Object(s["a"])({url:"/tp_dashboard/edit",method:"post",data:t})},del:function(t){return Object(s["a"])({url:"/tp_dashboard/delete",method:"post",data:t})},getTree:function(t){return Object(s["a"])({url:"/device/cascade",method:"post",data:t})}},c=e("30ab"),d=e("add0"),u=(Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_URL||(document.location.protocol,document.domain),{name:"VisualizationList",components:{TableTitle:i["a"]},data:function(){return{params:{current_page:1,per_page:10},loading:!1,total:0,tableData:[],localUrl:d["a"]}},created:function(){this.getVisualList()},methods:{handleCreate:function(){console.log("====handleCreate",this.tableData),this.tableData[0]&&this.tableData[0].status||this.tableData.unshift({dashboard_name:"",status:"creating",errors:{dashboard_name:""},formData:{dashboard_name:""}})},handleSave:function(t){var a=this;if(!t.formData.dashboard_name||!t.formData.dashboard_name.trim())return t.errors.dashboard_name="请填写名称",Object(o["h"])("可视化名称不能为空!"),!0;l.add(t.formData).then((function(t){var e=t.data;200==e.code?a.getVisualList():a.tableData.splice(0,1)})),t.status=null},handleCancel:function(t){if("creating"===t.status){var a=this.tableData.indexOf(t);this.tableData.splice(a,1)}t.status=null},getVisualList:function(){var t=this;this.tableData=[],this.loading||(this.loading=!0,l.list(this.params).then((function(a){var e=a.data;200==e.code&&(t.tableData=e.data.data,t.total=e.data.total,t.loading=!1)})).finally((function(){t.loading=!1})))},showVisual:function(t){var a=t.id,e=c["a"].getToken(),n=c["a"].getExpiresTime(),r="/visual",i="".concat(r,"/display?id=").concat(a,"&token=").concat(e,"&expiresTime=").concat(n);window.open(i,"_blank")},editVisual:function(t){var a=t.id,e=c["a"].getToken(),n=c["a"].getExpiresTime();sessionStorage.setItem("thingspanel_token",e);var r="/visual",i="".concat(r,"/editor?id=").concat(a,"&token=").concat(e,"&expiresTime=").concat(n);window.open(i,"_blank")},delVisual:function(t){var a=this;l.del({id:t.id}).then((function(t){var e=t.data;200==e.code&&(Object(o["i"])("删除成功!"),a.getVisualList())}))},showDeviceChart:function(t){console.log(t)}}}),p=u,f=(e("1b2c"),e("2877")),m=Object(f["a"])(p,n,r,!1,null,"52930f83",null);a["default"]=m.exports}}]);