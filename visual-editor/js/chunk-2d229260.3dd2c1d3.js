(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d229260"],{dbe1:function(e,t,a){"use strict";a.r(t),a.d(t,"setConditions",(function(){return y})),a.d(t,"setActions",(function(){return v})),a.d(t,"getConditions",(function(){return g})),a.d(t,"getActions",(function(){return m})),a.d(t,"ConditionType",(function(){return r})),a.d(t,"StateMode",(function(){return i})),a.d(t,"TimeType",(function(){return c})),a.d(t,"RepeatTimeType",(function(){return d})),a.d(t,"Week",(function(){return s})),a.d(t,"ActionType",(function(){return u})),a.d(t,"CommandType",(function(){return p}));var n=a("5530"),r=(a("7db0"),a("d3b7"),a("b64b"),a("b0c0"),a("38cf"),a("25f0"),a("159b"),a("e9c4"),a("a9e3"),a("ac1f"),a("1276"),{device:"1",time:"2",getKey:function(e){return Object.keys(r).find((function(t){return r[t]===e}))}}),i={property:"1",event:"2",onlineState:"3",onlineDuration:"4",getKey:function(e){return Object.keys(i).find((function(t){return i[t]===e}))}},o={online:"1",offline:"2",onAndOff:"3",getKey:function(e){return Object.keys(o).find((function(t){return o[t]===e}))}},c={range:"0",once:"1",repeat:"2",custom:"3",getKey:function(e){return Object.keys(c).find((function(t){return c[t]===e}))}},d={perHour:"1",days:"2",weekly:"3",monthly:"4",cron:"5",getKey:function(e){return Object.keys(d).find((function(t){return d[t]===e}))}},s={SUNDAY:1,MONDAY:2,TUESDAY:3,WEDNESDAY:4,THURSDAY:5,FRIDAY:6,SATURDAY:7},u={device:"1",alarm:"2",scene:"3",getKey:function(e){return Object.keys(u).find((function(t){return u[t]===e}))}},p={property:1,service:2};function y(e){var t=1,a=function(e){var a={};if("device"===e.type)a={condition_type:r.device,device_id:e.data.deviceId,device_condition_type:i[e.data.state.mode]},a.device_condition_type===i.property?(a["v1"]=e.data.state.name,a["v2"]=e.data.state.operator.symbol,a["v3"]=e.data.state.operator.value,a["v4"]=i.property):a.device_condition_type===i.onlineState?a["v2"]=o[e.data.state.name]:a.device_condition_type===i.event&&(a["v1"]=e.data.state.name,a["v3"]=e.data.state.params,a["v4"]=i.event);else if("time"===e.type)switch(a={condition_type:r.time,time_condition_type:c[e.data.type]},a.time_condition_type){case c.once:a["v1"]=e.data.once.value;break;case c.repeat:var n=e.data.repeat;switch(a["v1"]=d[n.type].toString(),d[n.type]){case d.perHour:a["v3"]=n.perHour.toString();break;case d.days:a["v3"]=n.days.toString();break;case d.weekly:var s=n.weekly.week;a["v3"]=s.toString(),a["v4"]=n.weekly.time.toString();break;case d.monthly:a["v3"]=n.monthly.day.toString()+":"+n.monthly.time.toString();break;case d.cron:a["v3"]=n.cron.toString()}break;case c.range:a["v1"]=e.data.range[0],a["v2"]=e.data.range[1];break}return e.relation&&"or"==e.relation&&t++,a.group_number=t,a},n=[];return e.length>0&&e.forEach((function(e){n.push(a(e))})),n}function v(e,t){var a=function(e){var a={};switch(a.action_type=u[e.type],a.action_type){case u.device:e.data.forEach((function(e){var t={},i={},o=e.state;"command"===e.state.mode?(t["device_model"]="2",i["method"]=o.name,i["params"]=JSON.parse(o.params)):"property"===e.state.mode?(console.log("属性",e.state),t["device_model"]="1",i[e.state.name]=e.state.operator.value):"custom"===e.state.mode&&(t["device_model"]="3",i=e.state.params),t["instruct"]=i,r.push(Object(n["a"])(Object(n["a"])({},a),{},{device_id:e.deviceId,additional_info:JSON.stringify(t)}))}));break;case u.scene:a.scenario_strategy_id=e.value||"",r.push(a);break;case u.alarm:a.warning_strategy={},a.warning_strategy.id=e.data.id?e.data.id:"",a.warning_strategy.warning_strategy_name=t,a.warning_strategy.warning_level=e.data.warningLevel,a.warning_strategy.group=e.data.group,a.warning_strategy.repeat_count=Number(e.data.repeatTimes),a.warning_strategy.inform_way=e.data.notification,a.warning_strategy.warning_description=e.data.warning_description,r.push(a);break}},r=[];return e.length>0&&e.forEach((function(e){a(e)})),r}function g(e){var t=[],a=1;if(e&&e.length>0)for(var n=0;n<e.length;n++){var s=e[n],u=s.group_number,p={};if(0===n?p.relation="":u===a?p.relation="and":u>a&&(p.relation="or",a=u),s.condition_type==r.device){p.type=r.getKey(s.condition_type),p.data={projectId:s.business_id,groupId:s.asset_id,deviceId:s.device_id};var y="",v={},g="";switch(s.device_condition_type){case i.property:y=s.v1,v["symbol"]=s.v2,v["value"]=s.v3;break;case i.onlineState:y=o.getKey(s.v2);break;case i.event:y=s.v1,g=s.v3;break}p.data.state={name:y,mode:i.getKey(s.device_condition_type),operator:v,params:g},p.data.stateJSON=JSON.stringify(p.data.state)}else switch(p.type=r.getKey(s.condition_type),p.data={type:c.getKey(s.time_condition_type)},s.time_condition_type){case c.once:p.data.once={value:s.v1};break;case c.repeat:switch(p.data.repeat={type:d.getKey(s.v1)},s.v1){case d.perHour:p.data.repeat.perHour=s.v3;break;case d.days:p.data.repeat.days=s.v3;break;case d.weekly:p.data.repeat.weekly={week:s.v3,time:s.v4};break;case d.monthly:var m=s.v3.split(":");p.data.repeat.monthly={day:m[0],time:m[1]+":"+m[2]};break;case d.cron:p.data.repeat.cron=s.v3;break}break;case c.range:p.data.range=[s.v1,s.v2];break;case c.custom:break}t.push(p)}else t.push({});return t}function m(e){var t=[],a=[];return e.forEach((function(e){var n={};if(e.action_type===u.device){var r={projectId:e.business_id,groupId:e.asset_id,deviceId:e.device_id,state:{}},i=e.additional_info?JSON.parse(e.additional_info):{};if("1"===i.device_model){var o=Object.keys(i.instruct||{})[0];r.state={name:o,mode:"property",operator:{symbol:"",value:i.instruct?i.instruct[o]:""}},r.stateJSON=JSON.stringify(r.state)}else"2"===i.device_model?(r.state={name:i.instruct.method,mode:"command",params:JSON.stringify(i.instruct.params)},r.stateJSON=JSON.stringify(r.state)):"3"===i.device_model&&(r.state={name:"custom",mode:"custom",params:i.instruct},r.stateJSON=JSON.stringify(r.state));a.push(r)}else if(e.action_type===u.alarm){var c,d,s,p,y;n.type="alarm",n.data={id:(null===(c=e.warning_strategy)||void 0===c?void 0:c.id)||"",warningLevel:(null===(d=e.warning_strategy)||void 0===d?void 0:d.warning_level)||"",repeatTimes:(null===(s=e.warning_strategy)||void 0===s?void 0:s.repeat_count)||0,notification:(null===(p=e.warning_strategy)||void 0===p?void 0:p.inform_way)||"",warning_description:(null===(y=e.warning_strategy)||void 0===y?void 0:y.warning_description)||""},t.push(n)}else e.action_type===u.scene&&(n.type="scene",n.value=e.scenario_strategy_id,t.push(n))})),a.length>0&&t.push({type:"device",data:a}),t}}}]);