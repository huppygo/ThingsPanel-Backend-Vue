(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a349e8e","chunk-2d22c950"],{"3b13":function(t,e,a){"use strict";a("fb6b")},"3b63":function(t,e,a){"use strict";var i=a("18a6");e["a"]={add:function(t){return Object(i["a"])({url:"/tp_protocol_plugin/add",method:"post",data:t})},edit:function(t){return Object(i["a"])({url:"/tp_protocol_plugin/edit",method:"post",data:t})},del:function(t){return Object(i["a"])({url:"/tp_protocol_plugin/delete",method:"post",data:t})},page:function(t){return Object(i["a"])({url:"/tp_protocol_plugin/list",method:"post",data:t})},getWVPDevices:function(t){return Object(i["a"])({url:"/wvp/query/devices",method:"post",data:t})},callPlayWVP:function(t){return Object(i["a"])({url:"/wvp/play/start/",method:"post",data:t})},commandPlayerPTZ:function(t){return Object(i["a"])({url:"/wvp/ptz",method:"post",data:t})},getRecordList:function(t){return Object(i["a"])({url:"/gb_record/query",method:"post",data:t})},getRecordURL:function(t){return Object(i["a"])({url:"/playback/start",method:"post",data:t})},stopRecordPlay:function(t){return Object(i["a"])({url:"/wvp/play/stop",method:"post",data:t})}}},"52e9":function(t,e,a){},7372:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{key:t.data.id,staticClass:"mb-5 text-center card-border margin-auto marketbox",attrs:{title:t.pluginData.name,"img-src":"media/logos/wsd.png","img-alt":"Image","img-top":"",tag:"article"}},[a("div",{staticStyle:{padding:"2.25rem"}},[a("b-card-text",{staticClass:"text-left text-muted"},[t._v(" "+t._s(t.$t("PLUGIN.TAB1_CONTENT.CLASSIFY"))+"："+t._s(t.pluginData.devicePluginTypeLabel)+" ")]),a("b-card-text",{staticClass:"text-left text-muted"},[t._v(" "+t._s(t.$t("PLUGIN.TAB1_CONTENT.VERSION"))+"："+t._s(t.pluginData.version)+" ")]),a("b-card-text",{staticClass:"text-left text-muted text-overflow"},[t._v(" "+t._s(t.$t("PLUGIN.TAB1_CONTENT.AUTHOR"))+"： "),a("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip"}],attrs:{title:t.pluginData.author}},[t._v(" "+t._s(t.pluginData.author)+" ")])]),a("b-card-text",{staticClass:"text-left text-muted"},[t._v(" "+t._s(t.$t("PLUGIN.TAB1_CONTENT.SCORE"))+"： "),a("v-rating",{staticClass:"d-inline-block v-application",attrs:{color:"orange",dense:"",small:"",readonly:""},model:{value:t.rating,callback:function(e){t.rating=e},expression:"rating"}})],1)],1),a("b-card-text",{staticStyle:{"margin-top":"10px"}},[a("b-btn",{directives:[{name:"show",rawName:"v-show",value:t.pluginData.pluginType===t.pluginType.Device,expression:"pluginData.pluginType === pluginType.Device"}],staticClass:"text-center",attrs:{variant:"warning",size:"sm"},on:{click:t.handleEdit}},[t._v(" "+t._s(t.$t("PLUGIN.TAB1_CONTENT.EDIT"))+" ")]),a("b-btn",{directives:[{name:"show",rawName:"v-show",value:!t.isInstalled,expression:"!isInstalled"}],staticClass:"text-center installing",attrs:{variant:"primary",size:"sm",disabled:t.installing||t.isInstalled},on:{click:t.handleInstall}},[t._v(" "+t._s(t.installing?t.$t("PLUGIN.TAB1_CONTENT.INSTALLING_TITLE"):t.$t("PLUGIN.TAB1_CONTENT.INSTALL"))+" ")]),a("b-btn",{directives:[{name:"show",rawName:"v-show",value:t.isInstalled,expression:"isInstalled"}],staticClass:"text-center",staticStyle:{"margin-left":"20px"},attrs:{variant:"success",size:"sm"},on:{click:t.handleShowExport}},[t._v(" "+t._s(t.$t("PLUGIN.TAB1_CONTENT.EXPORT"))+" ")]),a("b-btn",{directives:[{name:"show",rawName:"v-show",value:t.isInstalled,expression:"isInstalled"}],staticClass:"text-center",staticStyle:{"margin-left":"20px"},attrs:{disabled:!t.hasAuth("plugin:device:del"),variant:"danger",size:"sm"},on:{click:t.handleUninstall}},[t._v(" "+t._s(t.$t("PLUGIN.TAB1_CONTENT.UNINSTALL"))+" ")])],1)],1)},n=[],l=(a("9e1f"),a("450d"),a("6ed5")),s=a.n(l),o=(a("e9c4"),a("2fa3")),r=a("9448"),c=a("8cb6"),u={name:"PluginCard",props:{data:{type:Object,default:function(){}},isInstalled:{type:Boolean,default:!1}},data:function(){return{pluginData:{},rating:5,installing:!1,exportPluginJson:"",exportDialogVisible:!1,pluginType:c["PluginType"]}},created:function(){this.pluginData=JSON.parse(JSON.stringify(this.data)),console.log("===PluginCard.pluginData",this.pluginData)},methods:{handleEdit:function(){this.$emit("edit",this.pluginData)},handleInstall:function(){var t=this;this.installing=!0,setTimeout((function(){Object(o["i"])("安装成功！"),t.$emit("installed",t.data)}),2e3)},clickPlugin:function(t){console.log("====clickPlugin",t)},handleShowExport:function(){this.$emit("export",this.pluginData)},handleUninstall:function(){var t=this;s.a.confirm(this.$t("PLUGIN.TAB1_CONTENT.TIP_TEXT"),this.$t("PLUGIN.TAB1_CONTENT.TIP"),{confirmButtonText:this.$t("PLUGIN.TAB1_CONTENT.CONFIRM"),cancelButtonText:this.$t("PLUGIN.TAB1_CONTENT.CANCEL"),type:"warning"}).then((function(){r["a"].del({id:t.pluginData.id}).then((function(e){var a=e.data;200==a.code&&(Object(o["i"])("卸载成功！"),t.$emit("delete",t.pluginData))}))})).catch((function(){}))},handleExport:function(){},onCopy:function(t){Object(o["i"])("复制成功！")},onError:function(t){console.log(t)}}},d=u,p=(a("3b13"),a("2877")),g=a("6544"),T=a.n(g),f=a("1d4d"),m=Object(p["a"])(d,i,n,!1,null,"422d0352",null);e["default"]=m.exports;T()(m,{VRating:f["a"]})},"772f":function(t,e,a){"use strict";a("52e9")},d5a5:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-form"},[a("el-form",{attrs:{"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:t.$t("PLUGIN.TAB1_CONTENT.PLUGIN_TYPE")+": "}},[a("el-radio-group",{attrs:{size:"small"},on:{change:t.handlePluginTypeChanged},model:{value:t.params.pluginType,callback:function(e){t.$set(t.params,"pluginType",e)},expression:"params.pluginType"}},[a("el-radio-button",{attrs:{label:t.pluginType.device}},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.DEVICE_PLUGIN")))]),a("el-radio-button",{attrs:{label:t.pluginType.script}},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.ANALYSIS_SCRIPT")))]),a("el-radio-button",{attrs:{label:t.pluginType.nodRed}},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.RULE_ENGINE")))]),a("el-radio-button",{attrs:{label:t.pluginType.protocol}},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.PROTOCOL_PLUGIN")))]),a("el-radio-button",{attrs:{label:t.pluginType.visual}},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.VISUAL_PLUGIN")))])],1)],1),a("el-form-item",{attrs:{label:t.$t("COMMON.SEARCH")+": "}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("div",{staticClass:"flex"},[a("el-input",{staticStyle:{"margin-right":"10px",width:"200px"},attrs:{size:"small",clearable:"",placeholder:t.$t("PLUGIN.TAB1_CONTENT.PLACEHOLDER")},model:{value:t.params.model_name,callback:function(e){t.$set(t.params,"model_name",e)},expression:"params.model_name"}}),a("el-button",{staticClass:"primary el-button--indigo",attrs:{icon:"el-icon-refresh",size:"mini",loading:t.refreshBtnLoading},on:{click:t.loadList}},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.SEARCH")))])],1)]),a("el-col",{staticClass:"flex",attrs:{span:4}},[a("el-button",{class:"grid"==t.params.displayMode?"isActive":"",attrs:{type:"border",size:"mini",icon:"el-icon-s-grid"},on:{click:function(e){return t.handleChangeDisplayMode("grid")}}}),a("el-button",{class:"table"==t.params.displayMode?"isActive":"",attrs:{type:"border",size:"mini",icon:"el-icon-s-unfold"},on:{click:function(e){return t.handleChangeDisplayMode("table")}}})],1)],1)],1)],1),"grid"===t.params.displayMode?a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoadig,expression:"listLoadig"}],attrs:{"element-loading-background":"rgba(45, 61, 136, 0.1)"}},t._l(t.listArr,(function(e,i){return a("div",{key:i,staticClass:"width-20"},[a("PluginCard",{key:e.id,attrs:{data:e,isInstalled:!0},on:{export:t.handleExportPlugin,edit:t.handleEditPlugin,delete:t.handleDelPlugin}})],1)})),0):a("div",[a("el-form",{staticClass:"inline-edit"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoadig,expression:"listLoadig"}],attrs:{data:t.listArr}},[a("el-table-column",{attrs:{label:t.$t("PLUGIN.TAB2_CONTENT.NAME"),prop:"name",align:"left"}}),a("el-table-column",{attrs:{label:t.$t("PLUGIN.TAB2_CONTENT.AUTHOR"),prop:"author",align:"left"}}),a("el-table-column",{attrs:{label:t.$t("PLUGIN.TAB2_CONTENT.DESCRIBE"),prop:"describe",align:"left"}}),a("el-table-column",{attrs:{label:t.$t("PLUGIN.TAB2_CONTENT.PLUGIN_TYPE"),prop:"devicePluginTypeLabel",align:"left"}}),a("el-table-column",{attrs:{align:"left",label:t.$t("PLUGIN.TAB2_CONTENT.OPERATION"),width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"left"}},[e.row.pluginType===t.pluginType.device?a("el-button",{attrs:{slot:"reference",size:"mini",type:"border"},on:{click:function(a){return t.handleEditPlugin(e.row)}},slot:"reference"},[t._v("编辑")]):t._e(),a("el-button",{attrs:{slot:"reference",size:"mini",type:"border"},on:{click:function(a){return t.handleExportPlugin(e.row)}},slot:"reference"},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.EXPORT")))]),a("el-popconfirm",{attrs:{"confirm-button-text":t.$t("COMMON.CONFIRM"),"cancel-button-text":t.$t("COMMON.CANCEL"),title:t.$t("PLUGIN.TAB2_CONTENT.TITLE4")},on:{confirm:function(a){return t.handleDelPlugin(e.row)}}},[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.UNINSTALL")))])],1)],1)]}}])})],1)],1)],1),a("div",{staticClass:"text-right py-3"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.params.total,"current-page":t.params.current_page,"page-size":t.params.per_page},on:{"update:currentPage":function(e){return t.$set(t.params,"current_page",e)},"update:current-page":function(e){return t.$set(t.params,"current_page",e)},"current-change":t.loadList}})],1),a("export-plugin",{attrs:{visible:t.exportDialogVisible,jsonObj:t.exportPluginJson},on:{"update:visible":function(e){t.exportDialogVisible=e}}})],1)},n=[],l=(a("d3b7"),a("d81d"),a("7372")),s=a("9448"),o=a("aa98"),r=a("3b63"),c=a("f49e"),u=a("8cb6"),d=a("2fa3"),p={name:"PluginList",components:{PluginCard:l["default"],ExportPlugin:c["default"]},data:function(){return{loading:!1,listLoadig:!1,pluginType:u["PluginType"],params:{total:0,current_page:1,per_page:10,pluginType:u["PluginType"].device,installationStatus:"all",displayMode:"grid"},list:[],listArr:[],searchValue:"",refreshBtnLoading:!1,exportDialogVisible:!1,exportPluginJson:{}}},created:function(){this.loadList()},watch:{searchValue:function(t){this.debounce(this.searchPlugin,500,t)}},methods:{loadList:function(){switch(console.log("loadList",this.params),this.params.pluginType){case u["PluginType"].device:this.loadDevicePluginList();break;case u["PluginType"].script:this.loadScriptPluginList();break;default:this.listArr=[]}},loadDevicePluginList:function(){var t=this;this.listLoadig=!0,this.listArr=[],s["a"].page(this.params).then((function(e){var a=e.data;if(200==a.code){var i,n,l,s;t.params.total=(null===(i=a.data)||void 0===i?void 0:i.total)||0,t.params.current_page=(null===(n=a.data)||void 0===n?void 0:n.current_page)||1,t.params.per_page=(null===(l=a.data)||void 0===l?void 0:l.per_page)||10;var o=(null===(s=a.data)||void 0===s?void 0:s.data)||[];t.listArr=o.map((function(t){return u["Wash"].device.fromTP(t)})),t.refreshBtnLoading=!1}})).finally((function(){setTimeout((function(){t.listLoadig=!1}),500)}))},loadProtocolPluginList:function(){var t=this;this.listLoadig=!0,r["a"].page(this.params).then((function(e){var a=e.data;200==a.code&&(t.loading=!1,t.params=a.data)})).finally((function(){setTimeout((function(){t.listLoadig=!1}),500)}))},loadScriptPluginList:function(){var t=this;this.loading=!0,this.listLoadig=!0,Object(o["l"])(this.params).then((function(e){var a=e.data;if(200==a.code){var i,n,l,s;t.params.total=(null===(i=a.data)||void 0===i?void 0:i.total)||0,t.params.current_page=(null===(n=a.data)||void 0===n?void 0:n.current_page)||1,t.params.per_page=(null===(l=a.data)||void 0===l?void 0:l.per_page)||10;var o=(null===(s=a.data)||void 0===s?void 0:s.data)||[];t.listArr=o.map((function(t){return u["Wash"].script.fromTP(t)})),consolelog("getCustomExchangeAgreementList",t.listArr),t.refreshBtnLoading=!1}})).finally((function(){setTimeout((function(){t.listLoadig=!1}),500)}))},handleEditPlugin:function(t){this.params.pluginType===u["PluginType"].device&&this.$emit("edit",t)},handleExportPlugin:function(t){this.exportPluginJson=t.chart_data||t.jsonData,this.exportDialogVisible=!0},handleDelPlugin:function(t){var e=this;s["a"].del({id:t.id}).then((function(t){var a=t.data;console.log("handleDelPlugin",a),200==a.code&&(Object(d["i"])("删除成功"),e.loadList())}))},handleChangeDisplayMode:function(t){this.params.displayMode=t},handlePluginTypeChanged:function(t){switch(console.log("handlePluginTypeChanged",t),t){case"device":break}this.params.current_page=1,this.loadList()},debounce:function(t,e,a){1!=g&&(setTimeout((function(){return g=null}),e),g=1,t(a))}}},g=null,T=p,f=(a("772f"),a("2877")),m=Object(f["a"])(T,i,n,!1,null,"48497224",null);e["default"]=m.exports},f49e:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{staticClass:"el-dark-dialog el-table-transparent",attrs:{title:t.$t("PLUGIN.TAB1_CONTENT.TITLE"),visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-row",[a("div",{staticStyle:{"margin-bottom":"10px",display:"flex","justify-content":"space-between"}})]),a("el-row",[a("el-input",{staticClass:"el-dark-input",attrs:{type:"textarea",rows:24,placeholder:t.$t("PLUGIN.TAB1_CONTENT.PLACEHOLDER1")},model:{value:t.exportPluginJson,callback:function(e){t.exportPluginJson=e},expression:"exportPluginJson"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.CANCEL")))]),a("el-button",{staticClass:"el-button--indigo",attrs:{type:"primary"},on:{click:t.handleExport}},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.EXPORT")))]),a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.exportPluginJson,expression:"exportPluginJson",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"el-button--indigo",attrs:{type:"primary"}},[t._v(t._s(t.$t("PLUGIN.TAB1_CONTENT.PLACEHOLDER2")))])],1)],1)],1)},n=[],l=a("53ca"),s=(a("e9c4"),{components:{},props:{visible:{type:[Boolean],default:!1},jsonObj:{type:[Object,String],default:"{}"}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},watch:{jsonObj:{handler:function(t){t&&("object"===Object(l["a"])(t)?this.exportPluginJson=JSON.stringify(t,null,4):this.exportPluginJson=JSON.stringify(JSON.parse(t),null,4))}}},data:function(){return{exportPluginJson:""}},methods:{handleExport:function(){},onCopy:function(t){message_success("复制成功！")},onError:function(t){console.log(t)}}}),o=s,r=a("2877"),c=Object(r["a"])(o,i,n,!1,null,"6fd9edd3",null);e["default"]=c.exports},fb6b:function(t,e,a){}}]);