(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66e75f05"],{"0cc0":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rounded p-5 card no-border v-application my-v-input",attrs:{"data-app":"true"}},[i("div",{staticClass:"system-box"},[i("p",{staticClass:"tab-title"},t._l(t.tabs,(function(e,a){return i("span",{key:a,class:{active:e.value==t.activeTab},on:{click:function(i){t.activeTab=e.value}}},[t._v(" "+t._s(t.$t(e.name)?t.$t(e.name):e.name)+" ")])})),0),i("div",{staticClass:"content"},[i("div",{directives:[{name:"show",rawName:"v-show",value:"installed"==t.activeTab,expression:"activeTab == 'installed'"}]},[i("installed-list",{ref:"installList",on:{edit:t.handleEditPlugin}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"market"==t.activeTab,expression:"activeTab == 'market'"}]},[i("market-list")],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"deviceEditor"==t.activeTab,expression:"activeTab == 'deviceEditor'"}]},[i("device-plugin",{ref:"pluginEditor",on:{save:t.handleSavePlugin}})],1)])])])},n=[],o=i("d5a5"),s=i("f54d"),l=i("561e"),r={name:"index",components:{InstalledList:o["default"],MarketList:s["default"],DevicePlugin:l["default"]},data:function(){return{activeTab:"installed",tabs:[{name:"PLUGIN.TAB1",value:"installed"},{name:"PLUGIN.TAB2",value:"market"},{name:"PLUGIN.TAB3",value:"deviceEditor"}]}},mounted:function(){var t=this.$route.query.tab;t&&(this.activeTab=t)},methods:{handleEditPlugin:function(t){this.$refs.pluginEditor.handleImport(t)},handleSavePlugin:function(){console.log("handleSavePlugin"),this.$refs.installList.loadList()}}},c=r,u=(i("6bde"),i("2877")),d=Object(u["a"])(c,a,n,!1,null,"0a0257a4",null);e["default"]=d.exports},"13bf":function(t,e,i){"use strict";i("16cb")},"16cb":function(t,e,i){},"561e":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"editor-container"},[i("div",{staticClass:"card-container"},[i("el-row",{attrs:{gutter:60}},[i("el-col",{attrs:{span:12}},[i("a",[i("el-card",{staticClass:"box-card",nativeOn:{click:function(e){return t.customPlugin.apply(null,arguments)}}},[i("div",{staticClass:"text-item"},[i("i",{staticClass:"el-icon-edit-outline icon"}),i("p",[t._v(t._s(t.$t("PLUGIN.TAB3_CONTENT.PLACEHOLDER1")))]),i("p",{staticClass:"tips"},[t._v(t._s(t.$t("PLUGIN.TAB3_CONTENT.PLACEHOLDER2")))])])])],1)]),i("el-col",{attrs:{span:12}},[i("a",[i("el-card",{staticClass:"box-card",nativeOn:{click:function(e){return t.showImportPlugin.apply(null,arguments)}}},[i("div",{staticClass:"text-item"},[i("i",{staticClass:"el-icon-folder-add icon"}),i("p",[t._v(t._s(t.$t("PLUGIN.TAB3_CONTENT.IMPOTPLUGINS")))]),i("p",{staticClass:"tips"},[t._v(t._s(t.$t("PLUGIN.TAB3_CONTENT.IMPORTUSE")))])])])],1)])],1)],1),i("DevicePluginEditor",{staticClass:"tp-dark-editor",attrs:{visible:t.showEditorDialog,title:t.$t("PLUGIN.CUSTOM_DEVICE_PLUGIN"),json:t.pluginJsonData,"plugin-category":t.pluginCategory},on:{"update:visible":function(e){t.showEditorDialog=e},save:t.save,publish:t.publish}}),i("LoginStore",{attrs:{visible:t.loginStoreDialogVisible},on:{"update:visible":function(e){t.loginStoreDialogVisible=e}}}),i("el-dialog",{staticClass:"el-dark-dialog el-table-transparent",attrs:{title:t.$t("PLUGIN.TAB3_CONTENT.TITLE"),visible:t.importDialogVisible,width:"30%"},on:{"update:visible":function(e){t.importDialogVisible=e}}},[i("el-row",[i("div",{staticStyle:{"margin-bottom":"10px",display:"flex","justify-content":"space-between"}},[i("span",{staticStyle:{"padding-top":"10px"}},[t._v(t._s(t.$t("PLUGIN.TAB3_CONTENT.JSONTEST")))]),i("el-upload",{staticClass:"upload-demo",attrs:{action:"#",limit:1}},[i("el-button",{staticClass:"el-button--indigo",attrs:{type:"primary"}},[t._v(t._s(t.$t("PLUGIN.TAB3_CONTENT.SELECTTHEFILE")))])],1)],1)]),i("el-row",[i("el-input",{staticClass:"el-dark-input",attrs:{type:"textarea",rows:24,placeholder:t.$t("PLUGIN.TAB3_CONTENT.PLACEHOLDER3")},model:{value:t.importPluginJson,callback:function(e){t.importPluginJson=e},expression:"importPluginJson"}})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"cancel"},on:{click:function(e){t.importDialogVisible=!1}}},[t._v(t._s(t.$t("PLUGIN.TAB3_CONTENT.CANCEL")))]),i("el-button",{attrs:{type:"export"},on:{click:function(e){return t.handleImport()}}},[t._v(t._s(t.$t("PLUGIN.TAB3_CONTENT.THEIMPORT")))])],1)],1)],1)},n=[],o=i("1da1"),s=(i("96cf"),i("d81d"),i("e9c4"),i("a9e3"),i("a4d3"),i("e01a"),i("9448")),l=i("2fa3"),r=i("73f5"),c=i("f8b4"),u={name:"PluginEditor",components:{LoginStore:c["default"]},data:function(){return{activeName:"",showEditorDialog:!1,pluginCategory:[],importDialogVisible:!1,importPluginJson:"",pluginJsonData:{},id:"",loginStoreDialogVisible:!1}},created:function(){var t=this;s["a"].category({current_page:1,per_page:9999,dict_code:"chart_type"}).then((function(e){var i=e.data;if(200==i.code){var a=i.data.data;t.pluginCategory=a.map((function(t){return{label:t.describe,value:t["dict_value"]}})).reverse(),console.log(t.pluginCategory)}}))},methods:{customPlugin:function(){this.id="",this.pluginJsonData={},this.showEditorDialog=!0,console.log("configuration")},showImportPlugin:function(){this.importDialogVisible=!0},handleImport:function(t){t?(this.pluginJsonData=JSON.parse(t.jsonData),this.id=t.id):(this.pluginJsonData=JSON.parse(this.importPluginJson),this.id=""),console.log("handleImport",this.pluginJsonData),this.showEditorDialog=!0},save:function(t,e){var i=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n={model_type:t.info.pluginCategory,chart_data:JSON.stringify(t),model_name:t.info.pluginName,author:t.info.author,version:t.info.version},i.id?(n.id=i.id,s["a"].edit(n).then((function(t){var a=t.data;200==a.code&&(i.importDialogVisible=!1,e&&e({code:200,msg:"修改成功"}),i.$emit("save"))}))):s["a"].add(n).then((function(t){var a=t.data;200==a.code&&(i.importDialogVisible=!1,e&&e({code:200,msg:"新增成功！"}))}));case 2:case"end":return a.stop()}}),a)})))()},publish:function(t,e){var i=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,o,s,c,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(console.log("publish",t),n=i.$store.getters.getStoreAuthenticated,!n){a.next=16;break}if(o={devicePluginType:Number(t.info.pluginCategory),pluginAuthor:t.info.author,pluginName:t.info.pluginName,dataResource:JSON.stringify(t),versionNumber:t.info.version,pluginDescribe:t.info.description},!t.info.thumbImg||!t.info.thumbImg[0].raw){a.next=12;break}return s=new FormData,s.append("file",t.info.thumbImg[0].raw),a.next=9,r["a"].upload(s);case 9:c=a.sent,u=c.data,o.coverUrl=u.data.file.url;case 12:console.log("publish",t.info),r["a"].publish.device(o).then((function(t){t.data;var i="上传成功，请等待审核，审核通过后可以在应用市场查看！";e&&e({code:200,msg:i})})),a.next=18;break;case 16:Object(l["h"])("请先登录仓库！"),i.loginStoreDialogVisible=!0;case 18:case"end":return a.stop()}}),a)})))()}}},d=u,p=(i("13bf"),i("2877")),g=Object(p["a"])(d,a,n,!1,null,"55ca0a23",null);e["default"]=g.exports},"6bde":function(t,e,i){"use strict";i("bc4a")},bc4a:function(t,e,i){}}]);